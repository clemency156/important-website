<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mehan.AI | Social Media Analytics Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <style>
        /* All your existing CSS remains exactly the same */
        :root {
            /* Primary Colors */
            --primary: #0066ff;
            --primary-light: #00d9ff;
            --primary-dark: #0052cc;
            --secondary: #ff2a6d;
            --secondary-light: #ff8e00;
            --success: #00ff9d;
            --warning: #ffd166;
            --danger: #ff3867;
            --info: #4cc9f0;
            
            /* Social Media Colors */
            --facebook: #1877F2;
            --instagram: #E4405F;
            --twitter: #1DA1F2;
            --linkedin: #0A66C2;
            --youtube: #FF0000;
            
            /* Neutral Colors */
            --dark: #0a0e17;
            --dark-light: #1a1f2e;
            --light: #ffffff;
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1e293b;
            --gray-900: #0f172a;
            
            /* Gradients */
            --gradient-primary: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            --gradient-secondary: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%);
            --gradient-success: linear-gradient(135deg, var(--success) 0%, #00ccff 100%);
            --gradient-dark: linear-gradient(135deg, var(--dark) 0%, var(--dark-light) 100%);
            --gradient-facebook: linear-gradient(135deg, var(--facebook) 0%, #00d9ff 100%);
            --gradient-instagram: linear-gradient(135deg, #833AB4 0%, #E4405F 50%, #FCAF45 100%);
            --gradient-twitter: linear-gradient(135deg, var(--twitter) 0%, #00d9ff 100%);
            
            /* Theme Variables */
            --bg-primary: var(--light);
            --bg-secondary: var(--gray-50);
            --bg-card: var(--light);
            --bg-sidebar: var(--gradient-dark);
            --text-primary: var(--gray-900);
            --text-secondary: var(--gray-600);
            --border-color: var(--gray-200);
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.12);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 50px -12px rgba(0, 0, 0, 0.25);
            --shadow-blue: 0 10px 30px rgba(0, 102, 255, 0.15);
            --shadow-pink: 0 10px 30px rgba(255, 42, 109, 0.15);
            --border-radius-sm: 8px;
            --border-radius-md: 12px;
            --border-radius-lg: 16px;
            --border-radius-xl: 24px;
            --transition-fast: 0.15s ease;
            --transition-base: 0.3s ease;
            --transition-slow: 0.5s ease;
            --glow-blue: 0 0 20px rgba(0, 102, 255, 0.3);
            --glow-pink: 0 0 20px rgba(255, 42, 109, 0.3);
        }

        /* Dark Theme */
        .dark-theme {
            --bg-primary: var(--dark);
            --bg-secondary: var(--dark-light);
            --bg-card: var(--dark-light);
            --bg-sidebar: var(--gradient-dark);
            --text-primary: var(--light);
            --text-secondary: var(--gray-400);
            --border-color: var(--gray-700);
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 10px 25px -5px rgba(0, 0, 0, 0.5);
            --shadow-xl: 0 20px 50px -12px rgba(0, 0, 0, 0.6);
        }

        /* Social Media Platform Cards */
        .platform-card {
            background: var(--bg-card);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-md);
            transition: var(--transition-base);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .platform-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .platform-card.facebook {
            border-top: 4px solid var(--facebook);
        }

        .platform-card.instagram {
            border-top: 4px solid var(--instagram);
        }

        .platform-card.twitter {
            border-top: 4px solid var(--twitter);
        }

        .platform-card.linkedin {
            border-top: 4px solid var(--linkedin);
        }

        .platform-card.youtube {
            border-top: 4px solid var(--youtube);
        }

        .platform-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .platform-icon {
            width: 50px;
            height: 50px;
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            margin-right: 15px;
            box-shadow: var(--shadow-md);
        }

        .platform-icon.facebook {
            background: var(--gradient-facebook);
        }

        .platform-icon.instagram {
            background: var(--gradient-instagram);
        }

        .platform-icon.twitter {
            background: var(--gradient-twitter);
        }

        .platform-icon.linkedin {
            background: var(--linkedin);
        }

        .platform-icon.youtube {
            background: var(--youtube);
        }

        .platform-info h4 {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .platform-info p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .platform-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .platform-stat {
            text-align: center;
        }

        .platform-stat h3 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
            font-family: 'Orbitron', sans-serif;
        }

        .platform-stat p {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .platform-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .platform-btn {
            flex: 1;
            padding: 10px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md);
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition-base);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .platform-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Data Table */
        .data-table {
            width: 100%;
            background: var(--bg-card);
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
        }

        .data-table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .data-table-content {
            overflow-x: auto;
        }

        .data-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            padding: 15px 20px;
            text-align: left;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-secondary);
        }

        .data-table td {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            font-size: 14px;
        }

        .data-table tr:hover {
            background: var(--bg-secondary);
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        /* API Status */
        .api-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .api-status.connected {
            background: rgba(0, 255, 157, 0.1);
            color: var(--success);
        }

        .api-status.disconnected {
            background: rgba(255, 56, 103, 0.1);
            color: var(--danger);
        }

        .api-status.pending {
            background: rgba(255, 209, 102, 0.1);
            color: var(--warning);
        }

        /* Platform Progress */
        .platform-progress {
            height: 6px;
            background: var(--bg-secondary);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
        }

        .platform-progress-bar {
            height: 100%;
            border-radius: 3px;
            transition: var(--transition-base);
        }

        .progress-facebook {
            background: var(--facebook);
        }

        .progress-instagram {
            background: var(--instagram);
        }

        .progress-twitter {
            background: var(--twitter);
        }

        /* Social Media Insights */
        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .insight-card {
            background: var(--bg-card);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
        }

        .insight-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .insight-trend {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            font-weight: 600;
        }

        .insight-trend.positive {
            color: var(--success);
        }

        .insight-trend.negative {
            color: var(--danger);
        }

        /* Add these to your existing CSS */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: var(--transition-base);
            min-height: 100vh;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Orbitron', sans-serif;
            font-weight: 700;
            line-height: 1.2;
        }

        /* Auth Pages */
        .auth-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: var(--gradient-dark);
            position: relative;
            overflow: hidden;
        }

        .auth-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(0, 102, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 42, 109, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(0, 217, 255, 0.05) 0%, transparent 50%);
            z-index: 1;
        }

        .auth-wrapper {
            position: relative;
            z-index: 2;
            width: 100%;
            max-width: 1200px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: center;
        }

        .auth-hero {
            text-align: center;
            padding: 40px;
        }

        .auth-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .auth-logo-icon {
            width: 60px;
            height: 60px;
            background: var(--gradient-primary);
            border-radius: var(--border-radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: white;
            box-shadow: var(--glow-blue);
        }

        .auth-logo-text h1 {
            font-size: 36px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-align: left;
        }

        .auth-logo-text p {
            color: var(--gray-400);
            font-size: 14px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .auth-hero-content h2 {
            font-size: 42px;
            color: white;
            margin-bottom: 20px;
            line-height: 1.1;
        }

        .auth-hero-content p {
            color: var(--gray-400);
            font-size: 18px;
            margin-bottom: 30px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        .auth-features {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 40px;
        }

        .auth-feature {
            text-align: left;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius-md);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .auth-feature i {
            font-size: 24px;
            color: var(--primary-light);
            margin-bottom: 15px;
        }

        .auth-feature h4 {
            color: white;
            font-size: 16px;
            margin-bottom: 8px;
        }

        .auth-feature p {
            color: var(--gray-400);
            font-size: 14px;
            margin: 0;
        }

        /* Auth Forms */
        .auth-form-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius-xl);
            padding: 50px;
            box-shadow: var(--shadow-xl);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .auth-form-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        .auth-form-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .auth-form-header h2 {
            font-size: 32px;
            color: white;
            margin-bottom: 10px;
        }

        .auth-form-header p {
            color: var(--gray-400);
            font-size: 16px;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-label {
            color: white;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-label i {
            color: var(--primary-light);
            font-size: 12px;
        }

        .form-control {
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius-md);
            color: white;
            font-size: 16px;
            transition: var(--transition-base);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 102, 255, 0.1);
        }

        .form-control::placeholder {
            color: var(--gray-500);
        }

        .input-with-icon {
            position: relative;
        }

        .input-icon {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-400);
            cursor: pointer;
            transition: var(--transition-base);
        }

        .input-icon:hover {
            color: var(--primary-light);
        }

        .password-strength {
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            margin-top: 8px;
            overflow: hidden;
        }

        .password-strength-bar {
            height: 100%;
            width: 0%;
            border-radius: 2px;
            transition: var(--transition-base);
        }

        .strength-0 { width: 20%; background: var(--danger); }
        .strength-1 { width: 40%; background: var(--warning); }
        .strength-2 { width: 60%; background: var(--warning); }
        .strength-3 { width: 80%; background: var(--success); }
        .strength-4 { width: 100%; background: var(--success); }

        .form-check {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
        }

        .form-check-input {
            width: 18px;
            height: 18px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
        }

        .form-check-label {
            color: var(--gray-400);
            font-size: 14px;
            cursor: pointer;
        }

        .form-check-label a {
            color: var(--primary-light);
            text-decoration: none;
        }

        .form-check-label a:hover {
            text-decoration: underline;
        }

        .auth-btn {
            padding: 18px;
            background: var(--gradient-primary);
            border: none;
            border-radius: var(--border-radius-md);
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-base);
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-blue);
        }

        .auth-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .auth-divider {
            display: flex;
            align-items: center;
            margin: 30px 0;
        }

        .auth-divider::before,
        .auth-divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
        }

        .auth-divider span {
            padding: 0 20px;
            color: var(--gray-400);
            font-size: 14px;
        }

        .social-auth {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .social-btn {
            padding: 14px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius-md);
            color: white;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition-base);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .social-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .social-btn.google i { color: #ea4335; }
        .social-btn.github i { color: white; }
        .social-btn.microsoft i { color: #00a4ef; }

        .auth-footer {
            text-align: center;
            margin-top: 30px;
            color: var(--gray-400);
            font-size: 14px;
        }

        .auth-link {
            color: var(--primary-light);
            text-decoration: none;
            font-weight: 600;
            margin-left: 5px;
            transition: var(--transition-base);
        }

        .auth-link:hover {
            color: white;
            text-decoration: underline;
        }

        /* Dashboard Layout */
        .dashboard-container {
            display: none;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--bg-sidebar);
            color: white;
            display: flex;
            flex-direction: column;
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            z-index: 1000;
            box-shadow: var(--shadow-lg);
            transition: var(--transition-base);
        }

        .sidebar-header {
            padding: 30px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .sidebar-logo-icon {
            width: 45px;
            height: 45px;
            background: var(--gradient-primary);
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            color: white;
            box-shadow: var(--glow-blue);
        }

        .sidebar-logo-text h2 {
            font-size: 22px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 4px;
        }

        .sidebar-logo-text p {
            color: var(--gray-400);
            font-size: 11px;
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }

        .sidebar-nav {
            flex: 1;
            padding: 25px 20px;
            overflow-y: auto;
        }

        .nav-section {
            margin-bottom: 30px;
        }

        .nav-label {
            color: var(--gray-400);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            padding-left: 15px;
        }

        .nav-links {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 14px 20px;
            color: var(--gray-400);
            text-decoration: none;
            border-radius: var(--border-radius-md);
            transition: var(--transition-base);
            position: relative;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.05);
            color: white;
            transform: translateX(5px);
        }

        .nav-link.active {
            background: rgba(0, 102, 255, 0.15);
            color: white;
            box-shadow: inset 0 0 20px rgba(0, 102, 255, 0.1);
        }

        .nav-link.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 0 3px 3px 0;
        }

        .nav-link i {
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        .nav-badge {
            margin-left: auto;
            background: var(--secondary);
            color: white;
            font-size: 11px;
            padding: 3px 8px;
            border-radius: 20px;
            font-weight: 700;
        }

        .sidebar-footer {
            padding: 25px 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: var(--border-radius-md);
            object-fit: cover;
            border: 2px solid var(--primary);
            box-shadow: var(--glow-blue);
        }

        .user-info h4 {
            font-size: 15px;
            color: white;
            margin-bottom: 4px;
        }

        .user-info p {
            font-size: 12px;
            color: var(--gray-400);
            margin-bottom: 8px;
        }

        .user-plan {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            background: rgba(0, 102, 255, 0.1);
            color: var(--primary-light);
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 30px;
            transition: var(--transition-base);
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding-bottom: 25px;
            border-bottom: 1px solid var(--border-color);
        }

        .page-title h1 {
            font-size: 36px;
            margin-bottom: 10px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .page-title p {
            color: var(--text-secondary);
            font-size: 16px;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        /* Theme Toggle */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 20px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md);
            cursor: pointer;
            transition: var(--transition-base);
            box-shadow: var(--shadow-sm);
        }

        .theme-toggle:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .theme-icon {
            font-size: 18px;
            color: var(--primary);
        }

        .theme-text {
            font-weight: 500;
            font-size: 14px;
            color: var(--text-primary);
        }

        /* Search */
        .search-box {
            position: relative;
        }

        .search-box input {
            padding: 12px 20px 12px 45px;
            width: 300px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md);
            color: var(--text-primary);
            font-size: 15px;
            transition: var(--transition-base);
            box-shadow: var(--shadow-sm);
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: var(--shadow-blue);
            width: 350px;
        }

        .search-box i {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 15px;
        }

        .action-btn {
            width: 48px;
            height: 48px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition-base);
            position: relative;
            box-shadow: var(--shadow-sm);
        }

        .action-btn:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .action-btn .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--secondary);
            color: white;
            font-size: 11px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            box-shadow: var(--shadow-md);
            transition: var(--transition-base);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stat-card.premium {
            border-color: var(--secondary);
            background: linear-gradient(135deg, var(--bg-card), rgba(255, 42, 109, 0.05));
        }

        .stat-card.premium::before {
            content: 'PREMIUM';
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--gradient-secondary);
            color: white;
            font-size: 10px;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 700;
            letter-spacing: 1px;
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: var(--border-radius-md);
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            box-shadow: var(--shadow-blue);
        }

        .stat-trend {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 20px;
            background: rgba(0, 255, 157, 0.1);
            color: var(--success);
        }

        .stat-trend.negative {
            background: rgba(255, 56, 103, 0.1);
            color: var(--danger);
        }

        .stat-content h3 {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 8px;
            font-family: 'Orbitron', sans-serif;
        }

        .stat-content p {
            color: var(--text-secondary);
            font-size: 15px;
            margin-bottom: 15px;
        }

        .stat-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .stat-period {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .stat-action {
            font-size: 13px;
            color: var(--primary);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-base);
        }

        .stat-action:hover {
            color: var(--primary-dark);
        }

        /* Charts Section */
        .charts-section {
            margin-bottom: 40px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .section-header h2 {
            font-size: 24px;
            color: var(--text-primary);
        }

        .section-header p {
            color: var(--text-secondary);
            font-size: 15px;
        }

        .section-actions {
            display: flex;
            gap: 10px;
        }

        .section-btn {
            padding: 10px 20px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md);
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition-base);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow-sm);
        }

        .section-btn:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .section-btn.primary {
            background: var(--gradient-primary);
            color: white;
            border: none;
        }

        .section-btn.primary:hover {
            box-shadow: var(--shadow-blue);
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
        }

        .chart-container {
            background: var(--bg-card);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
        }

        .chart-container.premium {
            border-color: var(--secondary);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .chart-title h3 {
            font-size: 18px;
            margin-bottom: 8px;
        }

        .chart-title p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .chart-actions {
            display: flex;
            gap: 10px;
        }

        .chart-btn {
            width: 36px;
            height: 36px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
            cursor: pointer;
            transition: var(--transition-base);
        }

        .chart-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .chart-viz {
            height: 300px;
            position: relative;
        }

        /* Activity Feed */
        .activity-feed {
            background: var(--bg-card);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
        }

        .activity-list {
            list-style: none;
        }

        .activity-item {
            display: flex;
            align-items: center;
            padding: 20px;
            border-radius: var(--border-radius-md);
            margin-bottom: 15px;
            background: var(--bg-secondary);
            transition: var(--transition-base);
        }

        .activity-item:hover {
            background: rgba(0, 102, 255, 0.05);
            transform: translateX(5px);
        }

        .activity-icon {
            width: 50px;
            height: 50px;
            border-radius: var(--border-radius-md);
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            font-size: 20px;
            color: white;
            box-shadow: var(--shadow-blue);
        }

        .activity-details h4 {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .activity-details p {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .activity-time {
            margin-left: auto;
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 600;
            padding: 6px 15px;
            border-radius: 20px;
            background: var(--bg-primary);
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 30px;
            right: 30px;
            z-index: 10000;
        }

        .toast {
            background: var(--bg-card);
            color: var(--text-primary);
            padding: 20px;
            border-radius: var(--border-radius-md);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: var(--shadow-lg);
            border-left: 4px solid var(--primary);
            transform: translateX(100%);
            opacity: 0;
            transition: var(--transition-base);
            min-width: 350px;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast i {
            font-size: 24px;
        }

        .toast.success {
            border-left-color: var(--success);
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        .toast.warning {
            border-left-color: var(--warning);
        }

        .toast.info {
            border-left-color: var(--info);
        }

        /* Responsive Design */
        @media (max-width: 1400px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .auth-wrapper {
                grid-template-columns: 1fr;
                max-width: 500px;
            }
            
            .auth-hero {
                display: none;
            }
        }

        @media (max-width: 1200px) {
            .sidebar {
                width: 250px;
            }
            
            .main-content {
                margin-left: 250px;
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .mobile-menu-btn {
                display: block !important;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
            }
            
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 20px;
            }
            
            .header-actions {
                width: 100%;
                flex-wrap: wrap;
            }
            
            .search-box input {
                width: 100%;
            }
            
            .search-box input:focus {
                width: 100%;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .auth-form-container {
                padding: 30px;
            }
            
            .social-auth {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 576px) {
            .auth-form-container {
                padding: 25px 20px;
            }
            
            .chart-container {
                padding: 20px;
            }
            
            .toast {
                min-width: 300px;
            }
            
            .section-actions {
                flex-wrap: wrap;
            }
            
            .platform-stats {
                grid-template-columns: 1fr;
            }
        }

        /* Mobile Menu Button */
        .mobile-menu-btn {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 999;
            width: 48px;
            height: 48px;
            background: var(--gradient-primary);
            border: none;
            border-radius: var(--border-radius-md);
            color: white;
            font-size: 20px;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .text-primary {
            color: var(--primary) !important;
        }

        .text-success {
            color: var(--success) !important;
        }

        .text-danger {
            color: var(--danger) !important;
        }

        .text-warning {
            color: var(--warning) !important;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .mb-30 {
            margin-bottom: 30px;
        }

        .mb-40 {
            margin-bottom: 40px;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .mt-30 {
            margin-top: 30px;
        }

        .mt-40 {
            margin-top: 40px;
        }
    </style>
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Auth Pages -->
    <div id="authContainer" class="auth-container">
        <!-- Login Form -->
        <div id="loginPage" class="auth-wrapper">
            <div class="auth-hero">
                <div class="auth-logo">
                    <div class="auth-logo-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="auth-logo-text">
                        <h1>MEHAN.AI</h1>
                        <p>SOCIAL MEDIA ANALYTICS</p>
                    </div>
                </div>
                
                <div class="auth-hero-content">
                    <h2>Social Media Intelligence</h2>
                    <p>Unified analytics dashboard for Facebook, Instagram, Twitter, LinkedIn, and YouTube with real-time insights and revenue tracking.</p>
                    
                    <div class="auth-features">
                        <div class="auth-feature">
                            <i class="fab fa-facebook"></i>
                            <h4>Facebook Analytics</h4>
                            <p>Page insights, ad performance, revenue tracking</p>
                        </div>
                        <div class="auth-feature">
                            <i class="fab fa-instagram"></i>
                            <h4>Instagram Insights</h4>
                            <p>Engagement metrics, story analytics, revenue streams</p>
                        </div>
                        <div class="auth-feature">
                            <i class="fab fa-twitter"></i>
                            <h4>Twitter Analytics</h4>
                            <p>Tweet performance, follower growth, monetization</p>
                        </div>
                        <div class="auth-feature">
                            <i class="fas fa-chart-network"></i>
                            <h4>Cross-Platform</h4>
                            <p>Unified reporting and comparative analysis</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="auth-form-container">
                <div class="auth-form-header">
                    <h2>Sign In</h2>
                    <p>Enter your credentials to access social media analytics</p>
                </div>

                <form class="auth-form" id="loginForm">
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-envelope"></i> Email Address
                        </label>
                        <input type="email" class="form-control" id="loginEmail" placeholder="you@company.com" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-lock"></i> Password
                        </label>
                        <div class="input-with-icon">
                            <input type="password" class="form-control" id="loginPassword" placeholder="Enter your password" required>
                            <i class="fas fa-eye input-icon" id="toggleLoginPassword"></i>
                        </div>
                    </div>

                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="rememberMe">
                        <label class="form-check-label" for="rememberMe">
                            Remember this device
                        </label>
                    </div>

                    <button type="submit" class="auth-btn" id="loginBtn">
                        <i class="fas fa-sign-in-alt"></i> Sign In to Dashboard
                    </button>

                    <div class="auth-divider">
                        <span>Or connect social media</span>
                    </div>

                    <div class="social-auth">
                        <button type="button" class="social-btn" onclick="connectPlatform('facebook')">
                            <i class="fab fa-facebook"></i> Facebook
                        </button>
                        <button type="button" class="social-btn" onclick="connectPlatform('instagram')">
                            <i class="fab fa-instagram"></i> Instagram
                        </button>
                        <button type="button" class="social-btn" onclick="connectPlatform('twitter')">
                            <i class="fab fa-twitter"></i> Twitter
                        </button>
                    </div>

                    <div class="auth-footer">
                        <p>
                            Don't have an account? 
                            <a href="#" class="auth-link" id="showSignup">Request Access</a>
                        </p>
                        <p class="mt-20">
                            <a href="#" class="auth-link" id="forgotPassword">Forgot Password?</a>
                        </p>
                    </div>
                </form>
            </div>
        </div>

        <!-- Signup Form -->
        <div id="signupPage" class="auth-wrapper" style="display: none;">
            <div class="auth-hero">
                <div class="auth-logo">
                    <div class="auth-logo-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="auth-logo-text">
                        <h1>MEHAN.AI</h1>
                        <p>SOCIAL MEDIA ANALYTICS</p>
                    </div>
                </div>
                
                <div class="auth-hero-content">
                    <h2>Unified Social Analytics</h2>
                    <p>Track performance, revenue, and engagement across all your social media platforms in one powerful dashboard.</p>
                    
                    <div class="auth-features">
                        <div class="auth-feature">
                            <i class="fas fa-database"></i>
                            <h4>Real-time Data</h4>
                            <p>Live data from Facebook, Instagram, Twitter APIs</p>
                        </div>
                        <div class="auth-feature">
                            <i class="fas fa-money-bill-wave"></i>
                            <h4>Revenue Tracking</h4>
                            <p>Track earnings from ads, sponsorships, commerce</p>
                        </div>
                        <div class="auth-feature">
                            <i class="fas fa-chart-pie"></i>
                            <h4>Advanced Analytics</h4>
                            <p>AI-powered insights and predictions</p>
                        </div>
                        <div class="auth-feature">
                            <i class="fas fa-sync-alt"></i>
                            <h4>Auto-sync</h4>
                            <p>Automatic data synchronization every 15 minutes</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="auth-form-container">
                <div class="auth-form-header">
                    <h2>Request Access</h2>
                    <p>Connect your social media accounts for unified analytics</p>
                </div>

                <form class="auth-form" id="signupForm">
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-user"></i> Full Name
                        </label>
                        <input type="text" class="form-control" id="signupName" placeholder="John Doe" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-envelope"></i> Work Email
                        </label>
                        <input type="email" class="form-control" id="signupEmail" placeholder="john.doe@company.com" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-building"></i> Organization
                        </label>
                        <input type="text" class="form-control" id="signupCompany" placeholder="Company Name" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-briefcase"></i> Role
                        </label>
                        <select class="form-control" id="signupRole" required>
                            <option value="">Select your role</option>
                            <option value="social_manager">Social Media Manager</option>
                            <option value="marketing">Marketing Director</option>
                            <option value="analyst">Data Analyst</option>
                            <option value="executive">Executive</option>
                            <option value="other">Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-lock"></i> Create Password
                        </label>
                        <div class="input-with-icon">
                            <input type="password" class="form-control" id="signupPassword" placeholder="Create a strong password" required>
                            <i class="fas fa-eye input-icon" id="toggleSignupPassword"></i>
                        </div>
                        <div class="password-strength">
                            <div class="password-strength-bar" id="passwordStrength"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-redo"></i> Confirm Password
                        </label>
                        <input type="password" class="form-control" id="signupConfirmPassword" placeholder="Confirm your password" required>
                    </div>

                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="termsAgreement" required>
                        <label class="form-check-label" for="termsAgreement">
                            I agree to the <a href="#" class="auth-link">Terms of Service</a> and <a href="#" class="auth-link">Privacy Policy</a>
                        </label>
                    </div>

                    <div class="form-check">
                        <input type="checkbox" class="form-check-input" id="connectSocial">
                        <label class="form-check-label" for="connectSocial">
                            Connect my social media accounts for immediate analytics
                        </label>
                    </div>

                    <button type="submit" class="auth-btn" id="signupBtn">
                        <i class="fas fa-paper-plane"></i> Submit Request
                    </button>

                    <div class="auth-footer">
                        <p>
                            Already have an account? 
                            <a href="#" class="auth-link" id="showLogin">Sign In</a>
                        </p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div class="dashboard-container" id="dashboardContainer">
        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>

        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <div class="sidebar-logo-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="sidebar-logo-text">
                        <h2>MEHAN.AI</h2>
                        <p>SOCIAL ANALYTICS</p>
                    </div>
                </div>
            </div>

            <div class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-label">Dashboard</div>
                    <ul class="nav-links">
                        <li class="nav-item">
                            <a href="#" class="nav-link active" data-page="overview">
                                <i class="fas fa-tachometer-alt"></i>
                                <span>Overview</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="platforms">
                                <i class="fas fa-th"></i>
                                <span>Platforms</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="analytics">
                                <i class="fas fa-chart-network"></i>
                                <span>Analytics Hub</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <div class="nav-label">Social Media</div>
                    <ul class="nav-links">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="facebook">
                                <i class="fab fa-facebook"></i>
                                <span>Facebook</span>
                                <span class="nav-badge" id="facebookBadge">Live</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="instagram">
                                <i class="fab fa-instagram"></i>
                                <span>Instagram</span>
                                <span class="nav-badge" id="instagramBadge">Live</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="twitter">
                                <i class="fab fa-twitter"></i>
                                <span>Twitter</span>
                                <span class="nav-badge" id="twitterBadge">Live</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="linkedin">
                                <i class="fab fa-linkedin"></i>
                                <span>LinkedIn</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="youtube">
                                <i class="fab fa-youtube"></i>
                                <span>YouTube</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <div class="nav-label">Revenue & Reports</div>
                    <ul class="nav-links">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="revenue">
                                <i class="fas fa-money-bill-wave"></i>
                                <span>Revenue Dashboard</span>
                                <span class="nav-badge">$</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="reports">
                                <i class="fas fa-file-alt"></i>
                                <span>Reports</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="comparison">
                                <i class="fas fa-balance-scale"></i>
                                <span>Platform Comparison</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <div class="nav-label">System</div>
                    <ul class="nav-links">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="api">
                                <i class="fas fa-code"></i>
                                <span>API Management</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="settings">
                                <i class="fas fa-cogs"></i>
                                <span>Settings</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-page="integrations">
                                <i class="fas fa-puzzle-piece"></i>
                                <span>Integrations</span>
                                <span class="nav-badge">5</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="sidebar-footer">
                <div class="user-profile">
                    <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="User" class="user-avatar" id="userAvatar">
                    <div class="user-info">
                        <h4 id="userName">Alex Morgan</h4>
                        <p id="userRole">Social Media Director</p>
                        <div class="user-plan">
                            <i class="fas fa-sync-alt"></i>
                            <span id="userPlan">Auto-sync: 15m</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="mainContent">
            <!-- Header -->
            <div class="header">
                <div class="page-title">
                    <h1 id="pageTitle">Social Media Dashboard</h1>
                    <p id="pageSubtitle">Real-time analytics from Facebook, Instagram, and Twitter</p>
                </div>

                <div class="header-actions">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search posts, analytics, revenue..." id="searchInput">
                    </div>

                    <div class="theme-toggle" id="themeToggle">
                        <div class="theme-icon">
                            <i class="fas fa-sun"></i>
                        </div>
                        <div class="theme-text">Light Mode</div>
                    </div>

                    <div class="quick-actions">
                        <div class="action-btn" id="syncBtn">
                            <i class="fas fa-sync-alt"></i>
                        </div>
                        <div class="action-btn" id="notificationBtn">
                            <i class="fas fa-bell"></i>
                            <div class="badge">3</div>
                        </div>
                        <div class="action-btn" id="helpBtn">
                            <i class="fas fa-question"></i>
                        </div>
                        <div class="action-btn" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Content -->
            <div id="dashboardContent">
                <!-- Content loaded dynamically -->
            </div>
        </div>
    </div>

    <script>
        // ==================== API INTEGRATION SYSTEM ====================
        
        // 1. API Configuration
        const API_CONFIG = {
            facebook: {
                apiVersion: 'v18.0',
                scopes: ['pages_read_engagement', 'pages_read_user_content', 'ads_read', 'business_management'],
                endpoints: {
                    page: 'https://graph.facebook.com/v18.0/me/accounts',
                    insights: 'https://graph.facebook.com/v18.0/{page_id}/insights',
                    posts: 'https://graph.facebook.com/v18.0/{page_id}/posts',
                    ads: 'https://graph.facebook.com/v18.0/{ad_account_id}/campaigns'
                }
            },
            instagram: {
                apiVersion: 'v18.0',
                scopes: ['instagram_basic', 'instagram_content_publish', 'instagram_manage_comments', 'instagram_manage_insights'],
                endpoints: {
                    user: 'https://graph.facebook.com/v18.0/me/accounts?fields=instagram_business_account',
                    media: 'https://graph.facebook.com/v18.0/{ig_user_id}/media',
                    insights: 'https://graph.facebook.com/v18.0/{ig_user_id}/insights',
                    commerce: 'https://graph.facebook.com/v18.0/{ig_user_id}/product_catalog'
                }
            },
            twitter: {
                apiVersion: 'v2',
                scopes: ['tweet.read', 'tweet.write', 'users.read', 'follows.read', 'offline.access'],
                endpoints: {
                    user: 'https://api.twitter.com/2/users/me',
                    tweets: 'https://api.twitter.com/2/users/{user_id}/tweets',
                    analytics: 'https://api.twitter.com/2/tweets/{tweet_id}/public_metrics',
                    followers: 'https://api.twitter.com/2/users/{user_id}/followers'
                }
            }
        };

        // API Credentials (In production, these should be stored server-side)
        const API_CREDENTIALS = {
            facebook: {
                clientId: 'YOUR_FACEBOOK_APP_ID',
                clientSecret: 'YOUR_FACEBOOK_APP_SECRET'
            },
            instagram: {
                clientId: 'YOUR_INSTAGRAM_APP_ID',
                clientSecret: 'YOUR_INSTAGRAM_APP_SECRET'
            },
            twitter: {
                clientId: 'YOUR_TWITTER_CLIENT_ID',
                clientSecret: 'YOUR_TWITTER_CLIENT_SECRET'
            }
        };

        // Social Media Configuration
        const SOCIAL_PLATFORMS = {
            facebook: {
                name: 'Facebook',
                color: '#1877F2',
                icon: 'fab fa-facebook',
                stats: {
                    followers: 0,
                    engagement: 0,
                    reach: 0,
                    revenue: 0
                },
                api: {
                    connected: false,
                    lastSync: null
                }
            },
            instagram: {
                name: 'Instagram',
                color: '#E4405F',
                icon: 'fab fa-instagram',
                stats: {
                    followers: 0,
                    engagement: 0,
                    reach: 0,
                    revenue: 0
                },
                api: {
                    connected: false,
                    lastSync: null
                }
            },
            twitter: {
                name: 'Twitter',
                color: '#1DA1F2',
                icon: 'fab fa-twitter',
                stats: {
                    followers: 0,
                    engagement: 0,
                    reach: 0,
                    revenue: 0
                },
                api: {
                    connected: false,
                    lastSync: null
                }
            },
            linkedin: {
                name: 'LinkedIn',
                color: '#0A66C2',
                icon: 'fab fa-linkedin',
                stats: {
                    followers: 0,
                    engagement: 0,
                    reach: 0,
                    revenue: 0
                },
                api: {
                    connected: false,
                    lastSync: null
                }
            },
            youtube: {
                name: 'YouTube',
                color: '#FF0000',
                icon: 'fab fa-youtube',
                stats: {
                    subscribers: 0,
                    views: 0,
                    engagement: 0,
                    revenue: 0
                },
                api: {
                    connected: false,
                    lastSync: null
                }
            }
        };

        // Updated Users for Login
        const USERS = {
            'admin@mehan.ai': { password: 'AdminPass123!', role: 'admin' },
            'analyst@mehan.ai': { password: 'AnalystPass123!', role: 'analyst' },
            'viewer@mehan.ai': { password: 'ViewerPass123!', role: 'viewer' }
        };

        // Application State
        let currentUser = null;
        let currentPage = 'overview';
        let isDarkTheme = false;
        let chartInstances = {};
        let socialData = JSON.parse(JSON.stringify(SOCIAL_PLATFORMS));
        let autoSyncInterval = null;

        // 2. OAuth Flow Implementation
        function initiateOAuth(platform) {
            const redirectUri = `${window.location.origin}/oauth/callback`;
            const oauthUrls = {
                facebook: `https://www.facebook.com/v18.0/dialog/oauth?client_id=${API_CREDENTIALS.facebook.clientId}&redirect_uri=${redirectUri}&scope=${API_CONFIG.facebook.scopes.join(',')}&response_type=code`,
                instagram: `https://www.facebook.com/v18.0/dialog/oauth?client_id=${API_CREDENTIALS.instagram.clientId}&redirect_uri=${redirectUri}&scope=${API_CONFIG.instagram.scopes.join(',')}&response_type=code`,
                twitter: `https://twitter.com/i/oauth2/authorize?client_id=${API_CREDENTIALS.twitter.clientId}&redirect_uri=${redirectUri}&scope=${API_CONFIG.twitter.scopes.join(' ')}&response_type=code&code_challenge=challenge&code_challenge_method=plain`
            };
            
            showToast(`Redirecting to ${platform} authorization...`, 'info');
            
            // Store platform for callback
            sessionStorage.setItem('oauth_platform', platform);
            
            // Open in popup for better UX
            const width = 600;
            const height = 700;
            const left = window.screen.width / 2 - width / 2;
            const top = window.screen.height / 2 - height / 2;
            
            const popup = window.open(
                oauthUrls[platform],
                `${platform}_oauth`,
                `width=${width},height=${height},top=${top},left=${left},resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=no,status=no`
            );
            
            // Check for OAuth completion
            const checkPopup = setInterval(() => {
                if (popup.closed) {
                    clearInterval(checkPopup);
                    checkOAuthStatus(platform);
                }
            }, 500);
        }

        // Check OAuth status after popup closes
        function checkOAuthStatus(platform) {
            const token = TOKEN_MANAGER.getTokens(platform);
            if (token && token.access_token) {
                showToast(`${platform.charAt(0).toUpperCase() + platform.slice(1)} connected successfully!`, 'success');
                socialData[platform].api.connected = true;
                socialData[platform].api.lastSync = new Date();
                updatePlatformBadge(platform);
                
                // Fetch initial data
                fetchPlatformData(platform);
            } else {
                showToast(`${platform.charAt(0).toUpperCase() + platform.slice(1)} connection cancelled`, 'warning');
            }
        }

        // 3. Token Management System
        const TOKEN_MANAGER = {
            storeTokens: function(platform, tokens) {
                const tokenData = {
                    access_token: tokens.access_token,
                    refresh_token: tokens.refresh_token,
                    expires_in: tokens.expires_in,
                    obtained_at: Date.now()
                };
                
                const encrypted = btoa(JSON.stringify(tokenData));
                localStorage.setItem(`mehan_${platform}_tokens`, encrypted);
                
                // Schedule token refresh
                this.scheduleTokenRefresh(platform, tokens.expires_in);
                
                // Update social data
                socialData[platform].api.connected = true;
                socialData[platform].api.lastSync = new Date();
                
                return tokenData;
            },
            
            getTokens: function(platform) {
                try {
                    const encrypted = localStorage.getItem(`mehan_${platform}_tokens`);
                    if (!encrypted) return null;
                    
                    const tokens = JSON.parse(atob(encrypted));
                    
                    // Check if token is expired
                    const now = Date.now();
                    const expiresAt = tokens.obtained_at + (tokens.expires_in * 1000);
                    
                    if (now >= expiresAt) {
                        // Token expired, attempt refresh
                        this.refreshToken(platform);
                        return null;
                    }
                    
                    return tokens;
                } catch (error) {
                    console.error('Error retrieving tokens:', error);
                    return null;
                }
            },
            
            scheduleTokenRefresh: function(platform, expiresIn) {
                // Refresh token 5 minutes before expiry
                const refreshTime = (expiresIn - 300) * 1000;
                
                // Clear existing timeout if any
                if (this.refreshTimeout) {
                    clearTimeout(this.refreshTimeout);
                }
                
                this.refreshTimeout = setTimeout(() => {
                    this.refreshToken(platform);
                }, refreshTime);
            },
            
            refreshToken: async function(platform) {
                const tokens = this.getTokens(platform);
                if (!tokens || !tokens.refresh_token) {
                    showToast(`${platform} token expired. Please reconnect.`, 'warning');
                    socialData[platform].api.connected = false;
                    updatePlatformBadge(platform);
                    return;
                }
                
                try {
                    showToast(`Refreshing ${platform} token...`, 'info');
                    
                    // In production, this would be a server-side call
                    const response = await fetch(`/api/${platform}/refresh`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ refresh_token: tokens.refresh_token })
                    });
                    
                    if (response.ok) {
                        const newTokens = await response.json();
                        this.storeTokens(platform, newTokens);
                        showToast(`${platform} token refreshed`, 'success');
                    } else {
                        throw new Error('Token refresh failed');
                    }
                } catch (error) {
                    console.error(`Failed to refresh ${platform} token:`, error);
                    showToast(`Failed to refresh ${platform} token. Please reconnect.`, 'error');
                    socialData[platform].api.connected = false;
                    updatePlatformBadge(platform);
                }
            },
            
            clearTokens: function(platform) {
                localStorage.removeItem(`mehan_${platform}_tokens`);
                socialData[platform].api.connected = false;
                socialData[platform].api.lastSync = null;
                
                // Reset stats
                socialData[platform].stats = {
                    followers: 0,
                    engagement: 0,
                    reach: 0,
                    revenue: 0
                };
                
                updatePlatformBadge(platform);
                showToast(`${platform} disconnected`, 'info');
            }
        };

        // 4. Data Validation & Error Handling
        const DATA_VALIDATOR = {
            validateResponse: function(platform, data) {
                const validators = {
                    facebook: this.validateFacebookData,
                    instagram: this.validateInstagramData,
                    twitter: this.validateTwitterData
                };
                
                const validator = validators[platform];
                if (validator) {
                    return validator(data);
                }
                return true; // Default validation passed
            },
            
            validateFacebookData: function(data) {
                if (!data || data.error) {
                    throw new Error(data?.error?.message || 'Invalid Facebook response');
                }
                
                // Validate required fields for different endpoints
                if (data.data && Array.isArray(data.data)) {
                    // Basic validation for page data
                    const required = ['id', 'name'];
                    data.data.forEach(item => {
                        required.forEach(field => {
                            if (!item[field]) {
                                throw new Error(`Missing Facebook field: ${field}`);
                            }
                        });
                    });
                }
                
                return true;
            },
            
            validateInstagramData: function(data) {
                if (!data || data.error) {
                    throw new Error(data?.error?.message || 'Invalid Instagram response');
                }
                return true;
            },
            
            validateTwitterData: function(data) {
                if (!data || data.errors) {
                    throw new Error(data?.errors?.[0]?.message || 'Invalid Twitter response');
                }
                return true;
            },
            
            handleAPIError: function(platform, error) {
                console.error(`${platform} API Error:`, error);
                
                const errorActions = {
                    'Invalid OAuth access token': () => TOKEN_MANAGER.refreshToken(platform),
                    'Session has expired': () => TOKEN_MANAGER.clearTokens(platform),
                    'Rate limit exceeded': () => this.handleRateLimit(platform),
                    'default': () => {
                        showToast(`${platform} API error: ${error.message}`, 'error');
                        CONNECTIVITY_MONITOR.updateStatus(platform, {
                            connected: false,
                            error: error.message,
                            lastChecked: new Date()
                        });
                    }
                };
                
                const errorMessage = error.message || error.toString();
                const action = errorActions[errorMessage] || errorActions.default;
                action();
            },
            
            handleRateLimit: function(platform) {
                showToast(`${platform} rate limit reached. Retrying in 1 minute...`, 'warning');
                setTimeout(() => {
                    if (socialData[platform].api.connected) {
                        fetchPlatformData(platform);
                    }
                }, 60000);
            }
        };

        // 5. Webhook Integration (Simulated for demo)
        const WEBHOOK_MANAGER = {
            setupWebhooks: async function() {
                if (!currentUser || currentUser.role !== 'admin') {
                    return; // Only admins can setup webhooks
                }
                
                const platforms = ['facebook', 'instagram', 'twitter'];
                for (const platform of platforms) {
                    if (socialData[platform].api.connected) {
                        await this.setupPlatformWebhook(platform);
                    }
                }
            },
            
            setupPlatformWebhook: async function(platform) {
                try {
                    // Simulate webhook setup
                    showToast(`Setting up ${platform} webhooks...`, 'info');
                    
                    // In production, this would be a real API call
                    setTimeout(() => {
                        showToast(`${platform} webhooks configured`, 'success');
                        this.startWebhookSimulation(platform);
                    }, 2000);
                    
                } catch (error) {
                    console.error(`Failed to setup ${platform} webhook:`, error);
                    showToast(`Webhook setup failed for ${platform}`, 'error');
                }
            },
            
            startWebhookSimulation: function(platform) {
                // Simulate webhook events for demo purposes
                setInterval(() => {
                    if (Math.random() > 0.7) { // 30% chance of event
                        const events = ['new_post', 'new_follower', 'new_engagement', 'new_revenue'];
                        const eventType = events[Math.floor(Math.random() * events.length)];
                        
                        this.handleWebhookEvent(platform, {
                            type: eventType,
                            platform: platform,
                            timestamp: new Date().toISOString(),
                            data: this.generateMockEventData(platform, eventType)
                        });
                    }
                }, 30000); // Check every 30 seconds
            },
            
            generateMockEventData: function(platform, eventType) {
                const baseData = {
                    platform: platform,
                    timestamp: new Date().toISOString()
                };
                
                switch(eventType) {
                    case 'new_post':
                        return {
                            ...baseData,
                            post_id: `post_${Date.now()}`,
                            message: 'New social media post published',
                            type: ['photo', 'video', 'text'][Math.floor(Math.random() * 3)]
                        };
                    case 'new_follower':
                        return {
                            ...baseData,
                            count: Math.floor(Math.random() * 10) + 1,
                            total_followers: socialData[platform].stats.followers + Math.floor(Math.random() * 10) + 1
                        };
                    case 'new_engagement':
                        return {
                            ...baseData,
                            likes: Math.floor(Math.random() * 100),
                            comments: Math.floor(Math.random() * 20),
                            shares: Math.floor(Math.random() * 50)
                        };
                    case 'new_revenue':
                        return {
                            ...baseData,
                            amount: Math.floor(Math.random() * 1000),
                            source: ['ad', 'sponsorship', 'affiliate', 'product'][Math.floor(Math.random() * 4)]
                        };
                    default:
                        return baseData;
                }
            },
            
            handleWebhookEvent: function(platform, event) {
                // Update real-time metrics
                switch(event.type) {
                    case 'new_post':
                        this.updateRealtimeMetrics(platform, 'posts', 1);
                        break;
                    case 'new_follower':
                        const followerCount = event.data.count || 1;
                        socialData[platform].stats.followers += followerCount;
                        this.updateRealtimeMetrics(platform, 'followers', followerCount);
                        break;
                    case 'new_engagement':
                        const engagement = (event.data.likes || 0) + (event.data.comments || 0) * 2;
                        this.updateRealtimeMetrics(platform, 'engagement', engagement);
                        break;
                    case 'new_revenue':
                        socialData[platform].stats.revenue += event.data.amount;
                        this.updateRealtimeMetrics(platform, 'revenue', event.data.amount);
                        break;
                }
                
                // Add to activity feed
                this.addToActivityFeed(platform, event);
                
                // Show notification
                this.showWebhookNotification(event);
            },
            
            updateRealtimeMetrics: function(platform, metric, value) {
                // Update UI if on the relevant page
                if (currentPage === platform || currentPage === 'overview') {
                    navigateToPage(currentPage); // Refresh current view
                }
            },
            
            addToActivityFeed: function(platform, event) {
                const activities = JSON.parse(localStorage.getItem('mehan_activities') || '[]');
                
                const activity = {
                    id: `webhook_${Date.now()}`,
                    platform: platform,
                    type: event.type,
                    title: this.getActivityTitle(platform, event.type),
                    description: this.getActivityDescription(event.data),
                    time: new Date().toISOString(),
                    icon: this.getActivityIcon(event.type)
                };
                
                activities.unshift(activity);
                localStorage.setItem('mehan_activities', JSON.stringify(activities.slice(0, 50))); // Keep last 50
                
                // Update activity feed if visible
                if (currentPage === 'overview') {
                    loadSocialActivities();
                }
            },
            
            getActivityTitle: function(platform, eventType) {
                const titles = {
                    'new_post': 'New Post Published',
                    'new_follower': 'New Followers',
                    'new_engagement': 'Engagement Spike',
                    'new_revenue': 'Revenue Generated'
                };
                return `${platform.charAt(0).toUpperCase() + platform.slice(1)}: ${titles[eventType] || 'New Activity'}`;
            },
            
            getActivityDescription: function(data) {
                if (data.amount) return `Generated $${data.amount} from ${data.source}`;
                if (data.count) return `Gained ${data.count} new followers`;
                if (data.type) return `Published new ${data.type}`;
                return 'New activity detected';
            },
            
            getActivityIcon: function(eventType) {
                const icons = {
                    'new_post': 'fa-paper-plane',
                    'new_follower': 'fa-user-plus',
                    'new_engagement': 'fa-heart',
                    'new_revenue': 'fa-money-bill-wave'
                };
                return icons[eventType] || 'fa-bell';
            },
            
            showWebhookNotification: function(event) {
                const notification = {
                    id: `webhook_notif_${Date.now()}`,
                    platform: event.platform,
                    message: this.getNotificationMessage(event),
                    type: event.type,
                    timestamp: new Date().toISOString(),
                    read: false
                };
                
                // Store notification
                const notifications = JSON.parse(localStorage.getItem('mehan_notifications') || '[]');
                notifications.unshift(notification);
                localStorage.setItem('mehan_notifications', JSON.stringify(notifications.slice(0, 20)));
                
                // Update notification badge
                updateNotificationBadge();
                
                // Show toast
                showToast(notification.message, 'info');
            },
            
            getNotificationMessage: function(event) {
                const platform = event.platform.charAt(0).toUpperCase() + event.platform.slice(1);
                
                switch(event.type) {
                    case 'new_post':
                        return `${platform}: New post published`;
                    case 'new_follower':
                        return `${platform}: ${event.data.count} new followers`;
                    case 'new_engagement':
                        return `${platform}: High engagement detected`;
                    case 'new_revenue':
                        return `${platform}: $${event.data.amount} revenue generated`;
                    default:
                        return `${platform}: New activity`;
                }
            }
        };

        // 6. Batch Processing & Caching
        const BATCH_PROCESSOR = {
            cache: new Map(),
            
            batchRequests: async function(platform, requests) {
                if (!RATE_LIMIT_MANAGER.checkRateLimit(platform)) {
                    throw new Error('Rate limit exceeded');
                }
                
                // Check cache first
                const cacheKey = this.generateCacheKey(platform, requests);
                const cachedData = this.cacheManager.get(cacheKey);
                if (cachedData) {
                    return cachedData;
                }
                
                // Process requests based on platform
                if (platform === 'facebook' || platform === 'instagram') {
                    return this.processFacebookBatch(platform, requests);
                } else if (platform === 'twitter') {
                    return this.processTwitterBatch(platform, requests);
                }
                
                throw new Error(`Batch processing not supported for ${platform}`);
            },
            
            processFacebookBatch: async function(platform, requests) {
                const tokens = TOKEN_MANAGER.getTokens(platform);
                if (!tokens) {
                    throw new Error('Not authenticated');
                }
                
                try {
                    const batch = requests.map(req => ({
                        method: req.method || 'GET',
                        relative_url: req.endpoint.replace(API_CONFIG[platform].apiVersion, 'v18.0'),
                        name: req.name
                    }));
                    
                    const response = await fetch(`https://graph.facebook.com/v18.0?batch=${encodeURIComponent(JSON.stringify(batch))}&access_token=${tokens.access_token}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`Batch request failed: ${response.status}`);
                    }
                    
                    const results = await response.json();
                    const processedResults = this.processBatchResults(results, requests);
                    
                    // Cache the results
                    const cacheKey = this.generateCacheKey(platform, requests);
                    this.cacheManager.set(cacheKey, processedResults, 300); // Cache for 5 minutes
                    
                    return processedResults;
                } catch (error) {
                    DATA_VALIDATOR.handleAPIError(platform, error);
                    throw error;
                }
            },
            
            processTwitterBatch: async function(platform, requests) {
                const tokens = TOKEN_MANAGER.getTokens(platform);
                if (!tokens) {
                    throw new Error('Not authenticated');
                }
                
                try {
                    // Twitter doesn't support batch API, so we process sequentially
                    const results = [];
                    for (const req of requests) {
                        if (!RATE_LIMIT_MANAGER.checkRateLimit(platform)) {
                            throw new Error('Rate limit exceeded during batch processing');
                        }
                        
                        const response = await fetch(req.endpoint, {
                            headers: {
                                'Authorization': `Bearer ${tokens.access_token}`,
                                'Content-Type': 'application/json'
                            }
                        });
                        
                        if (!response.ok) {
                            throw new Error(`Twitter request failed: ${response.status}`);
                        }
                        
                        const data = await response.json();
                        results.push({
                            name: req.name,
                            data: data
                        });
                        
                        // Respect Twitter rate limits
                        await this.delay(100);
                    }
                    
                    // Cache the results
                    const cacheKey = this.generateCacheKey(platform, requests);
                    this.cacheManager.set(cacheKey, results, 300);
                    
                    return results;
                } catch (error) {
                    DATA_VALIDATOR.handleAPIError(platform, error);
                    throw error;
                }
            },
            
            processBatchResults: function(results, originalRequests) {
                const processed = {};
                
                results.forEach((result, index) => {
                    const request = originalRequests[index];
                    try {
                        const data = JSON.parse(result.body);
                        processed[request.name] = data;
                    } catch (error) {
                        processed[request.name] = { error: 'Failed to parse response' };
                    }
                });
                
                return processed;
            },
            
            generateCacheKey: function(platform, requests) {
                const requestString = JSON.stringify(requests.map(req => ({
                    endpoint: req.endpoint,
                    params: req.params
                })));
                return `${platform}_${btoa(requestString)}`;
            },
            
            cacheManager: {
                set: function(key, data, ttl = 300) {
                    const item = {
                        data: data,
                        expiry: Date.now() + (ttl * 1000)
                    };
                    localStorage.setItem(`cache_${key}`, JSON.stringify(item));
                },
                
                get: function(key) {
                    try {
                        const item = JSON.parse(localStorage.getItem(`cache_${key}`));
                        if (!item) return null;
                        
                        if (Date.now() > item.expiry) {
                            localStorage.removeItem(`cache_${key}`);
                            return null;
                        }
                        
                        return item.data;
                    } catch (error) {
                        return null;
                    }
                },
                
                clear: function(pattern) {
                    Object.keys(localStorage).forEach(key => {
                        if (key.startsWith('cache_') && (!pattern || key.includes(pattern))) {
                            localStorage.removeItem(key);
                        }
                    });
                }
            },
            
            delay: function(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        };

        // 7. Analytics & Monitoring Dashboard
        const CONNECTIVITY_MONITOR = {
            status: {},
            
            monitorConnection: function(platform) {
                // Clear existing interval if any
                if (this.monitoringIntervals && this.monitoringIntervals[platform]) {
                    clearInterval(this.monitoringIntervals[platform]);
                }
                
                // Check connection every minute
                this.monitoringIntervals = this.monitoringIntervals || {};
                this.monitoringIntervals[platform] = setInterval(async () => {
                    await this.checkPlatformConnection(platform);
                }, 60000);
                
                // Initial check
                this.checkPlatformConnection(platform);
            },
            
            checkPlatformConnection: async function(platform) {
                const startTime = Date.now();
                try {
                    const tokens = TOKEN_MANAGER.getTokens(platform);
                    
                    if (!tokens) {
                        throw new Error('Not authenticated');
                    }
                    
                    // Test API endpoint
                    let testEndpoint;
                    if (platform === 'facebook' || platform === 'instagram') {
                        testEndpoint = 'https://graph.facebook.com/v18.0/me?fields=id,name';
                    } else if (platform === 'twitter') {
                        testEndpoint = 'https://api.twitter.com/2/users/me';
                    }
                    
                    const response = await fetch(testEndpoint, {
                        headers: {
                            'Authorization': `Bearer ${tokens.access_token}`
                        }
                    });
                    
                    const latency = Date.now() - startTime;
                    
                    if (response.ok) {
                        this.updateStatus(platform, {
                            connected: true,
                            latency: latency,
                            lastChecked: new Date(),
                            uptime: this.calculateUptime(platform)
                        });
                        
                        // Update badge
                        updatePlatformBadge(platform);
                    } else {
                        throw new Error(`API returned ${response.status}`);
                    }
                    
                } catch (error) {
                    this.updateStatus(platform, {
                        connected: false,
                        error: error.message,
                        lastChecked: new Date(),
                        latency: Date.now() - startTime
                    });
                    
                    // Update badge
                    updatePlatformBadge(platform);
                }
            },
            
            updateStatus: function(platform, status) {
                this.status[platform] = status;
                
                // Store in history
                const history = JSON.parse(localStorage.getItem(`${platform}_status_history`) || '[]');
                history.push({
                    timestamp: new Date().toISOString(),
                    ...status
                });
                
                // Keep only last 100 entries
                localStorage.setItem(`${platform}_status_history`, JSON.stringify(history.slice(-100)));
            },
            
            calculateUptime: function(platform) {
                const history = JSON.parse(localStorage.getItem(`${platform}_status_history`) || '[]');
                if (history.length === 0) return 100;
                
                const successfulChecks = history.filter(check => check.connected).length;
                return (successfulChecks / history.length) * 100;
            },
            
            generateConnectivityReport: function() {
                const report = {
                    generated: new Date().toISOString(),
                    platforms: {},
                    summary: {
                        totalPlatforms: 0,
                        connectedPlatforms: 0,
                        averageUptime: 0,
                        issues: []
                    }
                };
                
                Object.keys(socialData).forEach(platform => {
                    report.platforms[platform] = this.status[platform] || {};
                    
                    if (socialData[platform].api.connected) {
                        report.summary.connectedPlatforms++;
                    }
                    
                    report.summary.totalPlatforms++;
                    
                    // Check for issues
                    if (!socialData[platform].api.connected) {
                        report.summary.issues.push({
                            platform: platform,
                            issue: 'Not connected',
                            severity: 'high'
                        });
                    } else if (this.status[platform] && this.status[platform].latency > 1000) {
                        report.summary.issues.push({
                            platform: platform,
                            issue: 'High latency',
                            severity: 'medium'
                        });
                    }
                });
                
                // Calculate average uptime
                const uptimes = Object.values(report.platforms)
                    .filter(p => p.uptime)
                    .map(p => p.uptime);
                
                if (uptimes.length > 0) {
                    report.summary.averageUptime = uptimes.reduce((a, b) => a + b, 0) / uptimes.length;
                }
                
                return report;
            },
            
            stopAllMonitoring: function() {
                if (this.monitoringIntervals) {
                    Object.values(this.monitoringIntervals).forEach(interval => {
                        clearInterval(interval);
                    });
                    this.monitoringIntervals = {};
                }
            }
        };

        // 8. Enhanced Security Features
        const SECURITY_MANAGER = {
            generateKey: async function() {
                // Generate a cryptographic key for encryption
                return await crypto.subtle.generateKey(
                    {
                        name: 'AES-GCM',
                        length: 256
                    },
                    true,
                    ['encrypt', 'decrypt']
                );
            },
            
            encryptData: async function(data) {
                try {
                    const encoder = new TextEncoder();
                    const encoded = encoder.encode(JSON.stringify(data));
                    
                    // Generate initialization vector
                    const iv = crypto.getRandomValues(new Uint8Array(12));
                    
                    // Get or create encryption key
                    let key = await this.getEncryptionKey();
                    if (!key) {
                        key = await this.generateKey();
                        await this.storeEncryptionKey(key);
                    }
                    
                    // Encrypt data
                    const encrypted = await crypto.subtle.encrypt(
                        {
                            name: 'AES-GCM',
                            iv: iv
                        },
                        key,
                        encoded
                    );
                    
                    // Combine IV and encrypted data
                    const combined = new Uint8Array(iv.length + encrypted.byteLength);
                    combined.set(iv);
                    combined.set(new Uint8Array(encrypted), iv.length);
                    
                    // Convert to base64 for storage
                    return btoa(String.fromCharCode(...combined));
                    
                } catch (error) {
                    console.error('Encryption failed:', error);
                    // Fallback to basic obfuscation
                    return btoa(JSON.stringify(data));
                }
            },
            
            decryptData: async function(encryptedData) {
                try {
                    // Decode base64
                    const binary = atob(encryptedData);
                    const bytes = new Uint8Array(binary.length);
                    for (let i = 0; i < binary.length; i++) {
                        bytes[i] = binary.charCodeAt(i);
                    }
                    
                    // Extract IV and encrypted data
                    const iv = bytes.slice(0, 12);
                    const encrypted = bytes.slice(12);
                    
                    // Get encryption key
                    const key = await this.getEncryptionKey();
                    if (!key) {
                        throw new Error('No encryption key found');
                    }
                    
                    // Decrypt data
                    const decrypted = await crypto.subtle.decrypt(
                        {
                            name: 'AES-GCM',
                            iv: iv
                        },
                        key,
                        encrypted
                    );
                    
                    // Decode to string
                    const decoder = new TextDecoder();
                    const decryptedString = decoder.decode(decrypted);
                    
                    return JSON.parse(decryptedString);
                    
                } catch (error) {
                    console.error('Decryption failed:', error);
                    // Try fallback decoding
                    try {
                        return JSON.parse(atob(encryptedData));
                    } catch {
                        throw new Error('Failed to decrypt data');
                    }
                }
            },
            
            getEncryptionKey: async function() {
                const keyData = localStorage.getItem('mehan_encryption_key');
                if (!keyData) return null;
                
                try {
                    const keyArray = JSON.parse(keyData);
                    return await crypto.subtle.importKey(
                        'jwk',
                        keyArray,
                        { name: 'AES-GCM' },
                        true,
                        ['encrypt', 'decrypt']
                    );
                } catch (error) {
                    console.error('Failed to load encryption key:', error);
                    return null;
                }
            },
            
            storeEncryptionKey: async function(key) {
                const keyData = await crypto.subtle.exportKey('jwk', key);
                localStorage.setItem('mehan_encryption_key', JSON.stringify(keyData));
            },
            
            validatePermissions: function(platform, requiredPermissions) {
                if (!currentUser) return false;
                
                // Admin has all permissions
                if (currentUser.role === 'admin') return true;
                
                const userPermissions = this.getUserPermissions();
                const platformPermissions = userPermissions.filter(p => p.platform === platform);
                
                return requiredPermissions.every(required => 
                    platformPermissions.some(permission => permission.name === required)
                );
            },
            
            getUserPermissions: function() {
                // Define permissions based on user role
                const permissions = {
                    admin: [
                        { platform: 'facebook', name: 'full_access' },
                        { platform: 'instagram', name: 'full_access' },
                        { platform: 'twitter', name: 'full_access' },
                        { platform: 'system', name: 'manage_users' },
                        { platform: 'system', name: 'manage_settings' }
                    ],
                    analyst: [
                        { platform: 'facebook', name: 'read_analytics' },
                        { platform: 'instagram', name: 'read_analytics' },
                        { platform: 'twitter', name: 'read_analytics' },
                        { platform: 'system', name: 'export_data' }
                    ],
                    viewer: [
                        { platform: 'facebook', name: 'read_only' },
                        { platform: 'instagram', name: 'read_only' },
                        { platform: 'twitter', name: 'read_only' }
                    ]
                };
                
                return permissions[currentUser.role] || permissions.viewer;
            },
            
            auditLog: function(action, details) {
                try {
                    const logEntry = {
                        timestamp: new Date().toISOString(),
                        userId: currentUser?.id || 'anonymous',
                        userEmail: currentUser?.email || 'unknown',
                        action: action,
                        details: details,
                        ip: this.getClientIP(),
                        userAgent: navigator.userAgent,
                        url: window.location.href
                    };
                    
                    const logs = JSON.parse(localStorage.getItem('audit_logs') || '[]');
                    logs.push(logEntry);
                    
                    // Keep only last 1000 entries
                    localStorage.setItem('audit_logs', JSON.stringify(logs.slice(-1000)));
                    
                } catch (error) {
                    console.error('Failed to write audit log:', error);
                }
            },
            
            getClientIP: function() {
                // In a real application, this would come from the server
                // For demo purposes, we'll simulate an IP
                return '203.0.113.' + Math.floor(Math.random() * 255);
            }
        };

        // 9. Multi-Account Support
        const ACCOUNT_MANAGER = {
            accounts: {},
            
            loadAccounts: function() {
                try {
                    const savedAccounts = localStorage.getItem('mehan_accounts');
                    if (savedAccounts) {
                        this.accounts = JSON.parse(savedAccounts);
                    }
                } catch (error) {
                    console.error('Failed to load accounts:', error);
                    this.accounts = {};
                }
            },
            
            saveAccounts: function() {
                try {
                    localStorage.setItem('mehan_accounts', JSON.stringify(this.accounts));
                } catch (error) {
                    console.error('Failed to save accounts:', error);
                }
            },
            
            addAccount: function(platform, accountData) {
                if (!this.accounts[platform]) {
                    this.accounts[platform] = [];
                }
                
                const account = {
                    id: accountData.id,
                    name: accountData.name,
                    type: accountData.type || 'business',
                    isActive: this.accounts[platform].length === 0,
                    connectedAt: new Date().toISOString(),
                    lastSync: null,
                    stats: {},
                    token: accountData.token || null
                };
                
                this.accounts[platform].push(account);
                this.saveAccounts();
                
                // Activate this account
                this.switchActiveAccount(platform, account.id);
                
                return account;
            },
            
            switchActiveAccount: function(platform, accountId) {
                if (!this.accounts[platform]) return;
                
                this.accounts[platform].forEach(account => {
                    account.isActive = account.id === accountId;
                });
                
                this.saveAccounts();
                
                // Refresh data for new active account
                if (socialData[platform].api.connected) {
                    fetchPlatformData(platform);
                }
                
                showToast(`Switched to ${platform} account`, 'info');
            },
            
            getActiveAccount: function(platform) {
                if (!this.accounts[platform]) return null;
                
                return this.accounts[platform].find(account => account.isActive) || 
                       this.accounts[platform][0];
            },
            
            removeAccount: function(platform, accountId) {
                if (!this.accounts[platform]) return;
                
                this.accounts[platform] = this.accounts[platform].filter(account => account.id !== accountId);
                
                // If we removed the active account, activate another one
                if (this.accounts[platform].length > 0 && !this.getActiveAccount(platform)) {
                    this.accounts[platform][0].isActive = true;
                }
                
                this.saveAccounts();
                
                // If no accounts left, disconnect platform
                if (this.accounts[platform].length === 0) {
                    TOKEN_MANAGER.clearTokens(platform);
                }
            },
            
            getAccounts: function(platform) {
                return this.accounts[platform] || [];
            }
        };

        // 10. Rate Limit Management
        const RATE_LIMIT_MANAGER = {
            limits: {
                facebook: { calls: [], resetTime: null, limit: 200, window: 3600000 },
                instagram: { calls: [], resetTime: null, limit: 100, window: 3600000 },
                twitter: { calls: [], resetTime: null, limit: 300, window: 900000 } // 15-minute window for Twitter
            },
            
            checkRateLimit: function(platform) {
                const now = Date.now();
                const platformLimit = this.limits[platform];
                
                if (!platformLimit) return true; // No limits for this platform
                
                // Clean old calls
                platformLimit.calls = platformLimit.calls.filter(time => now - time < platformLimit.window);
                
                // Check if we've hit the limit
                if (platformLimit.calls.length >= platformLimit.limit) {
                    if (!platformLimit.resetTime) {
                        platformLimit.resetTime = now + platformLimit.window;
                    }
                    
                    const waitTime = platformLimit.resetTime - now;
                    if (waitTime > 0) {
                        showToast(`${platform} rate limit reached. Resets in ${Math.ceil(waitTime/1000)}s`, 'warning');
                        return false;
                    } else {
                        // Reset time passed, clear and continue
                        platformLimit.resetTime = null;
                        platformLimit.calls = [];
                    }
                }
                
                // Add this call
                platformLimit.calls.push(now);
                return true;
            },
            
            getRateLimitStatus: function(platform) {
                const limit = this.limits[platform];
                if (!limit) return null;
                
                const now = Date.now();
                const callsInWindow = limit.calls.filter(time => now - time < limit.window).length;
                const remaining = Math.max(0, limit.limit - callsInWindow);
                const resetIn = limit.resetTime ? Math.max(0, limit.resetTime - now) : 0;
                
                return {
                    used: callsInWindow,
                    remaining: remaining,
                    limit: limit.limit,
                    resetIn: resetIn,
                    window: limit.window
                };
            },
            
            optimizeRequests: function(platform, requests) {
                // Group similar requests
                const grouped = {};
                
                requests.forEach(req => {
                    const key = this.getRequestKey(req);
                    if (!grouped[key]) {
                        grouped[key] = {
                            endpoint: req.endpoint,
                            params: req.params,
                            callbacks: []
                        };
                    }
                    grouped[key].callbacks.push(req.callback);
                });
                
                return Object.values(grouped);
            },
            
            getRequestKey: function(request) {
                // Create a unique key for request grouping
                return `${request.endpoint}_${JSON.stringify(request.params || {})}`;
            }
        };

        // 11. Data Export & Backup System
        const EXPORT_MANAGER = {
            formats: ['csv', 'json', 'pdf', 'excel'],
            
            exportPlatformData: async function(platform, format, dateRange) {
                try {
                    showToast(`Exporting ${platform} data as ${format}...`, 'info');
                    
                    // Check permissions
                    if (!SECURITY_MANAGER.validatePermissions(platform, ['export_data'])) {
                        throw new Error('Insufficient permissions for export');
                    }
                    
                    const data = await this.prepareExportData(platform, dateRange);
                    
                    let exportBlob;
                    let fileName;
                    
                    switch(format.toLowerCase()) {
                        case 'csv':
                            exportBlob = this.convertToCSV(data);
                            fileName = `${platform}_export_${new Date().toISOString().split('T')[0]}.csv`;
                            break;
                        case 'json':
                            exportBlob = this.convertToJSON(data);
                            fileName = `${platform}_export_${new Date().toISOString().split('T')[0]}.json`;
                            break;
                        case 'pdf':
                            // For demo, we'll create a simple PDF report
                            exportBlob = await this.generatePDFReport(data);
                            fileName = `${platform}_report_${new Date().toISOString().split('T')[0]}.pdf`;
                            break;
                        case 'excel':
                            exportBlob = await this.generateExcelReport(data);
                            fileName = `${platform}_export_${new Date().toISOString().split('T')[0]}.xlsx`;
                            break;
                        default:
                            throw new Error(`Unsupported format: ${format}`);
                    }
                    
                    // Create download link
                    const url = URL.createObjectURL(exportBlob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = fileName;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    // Log the export
                    SECURITY_MANAGER.auditLog('data_export', {
                        platform: platform,
                        format: format,
                        dateRange: dateRange,
                        fileName: fileName
                    });
                    
                    showToast(`Export completed: ${fileName}`, 'success');
                    
                    return fileName;
                    
                } catch (error) {
                    console.error('Export failed:', error);
                    showToast(`Export failed: ${error.message}`, 'error');
                    throw error;
                }
            },
            
            prepareExportData: async function(platform, dateRange) {
                const data = {
                    metadata: {
                        platform: platform,
                        exportDate: new Date().toISOString(),
                        dateRange: dateRange,
                        user: currentUser?.email || 'unknown'
                    },
                    stats: socialData[platform].stats,
                    apiStatus: socialData[platform].api,
                    recentData: []
                };
                
                // Add sample data for demo
                if (platform === 'facebook') {
                    data.recentData = await this.getSampleFacebookData();
                } else if (platform === 'instagram') {
                    data.recentData = await this.getSampleInstagramData();
                } else if (platform === 'twitter') {
                    data.recentData = await this.getSampleTwitterData();
                }
                
                return data;
            },
            
            convertToCSV: function(data) {
                const rows = [];
                
                // Add metadata
                rows.push(['Platform', data.metadata.platform]);
                rows.push(['Export Date', data.metadata.exportDate]);
                rows.push(['User', data.metadata.user]);
                rows.push([]);
                
                // Add stats
                rows.push(['Metric', 'Value']);
                Object.entries(data.stats).forEach(([key, value]) => {
                    rows.push([key, value]);
                });
                
                // Convert to CSV string
                const csvString = rows.map(row => 
                    row.map(cell => `"${String(cell).replace(/"/g, '""')}"`).join(',')
                ).join('\n');
                
                return new Blob([csvString], { type: 'text/csv;charset=utf-8;' });
            },
            
            convertToJSON: function(data) {
                const jsonString = JSON.stringify(data, null, 2);
                return new Blob([jsonString], { type: 'application/json;charset=utf-8;' });
            },
            
            generatePDFReport: async function(data) {
                // For demo, create a simple HTML report
                const html = `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>${data.metadata.platform} Report</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 40px; }
                            h1 { color: #333; }
                            .section { margin-bottom: 30px; }
                            table { width: 100%; border-collapse: collapse; }
                            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                            th { background-color: #f4f4f4; }
                        </style>
                    </head>
                    <body>
                        <h1>${data.metadata.platform.toUpperCase()} Analytics Report</h1>
                        <div class="section">
                            <h2>Export Information</h2>
                            <p><strong>Date:</strong> ${new Date(data.metadata.exportDate).toLocaleString()}</p>
                            <p><strong>User:</strong> ${data.metadata.user}</p>
                        </div>
                        <div class="section">
                            <h2>Platform Statistics</h2>
                            <table>
                                ${Object.entries(data.stats).map(([key, value]) => `
                                    <tr>
                                        <td><strong>${key}</strong></td>
                                        <td>${value}</td>
                                    </tr>
                                `).join('')}
                            </table>
                        </div>
                    </body>
                    </html>
                `;
                
                return new Blob([html], { type: 'text/html;charset=utf-8;' });
            },
            
            generateExcelReport: async function(data) {
                // For demo, create a simple CSV (in production, use a library like SheetJS)
                return this.convertToCSV(data);
            },
            
            scheduleAutoExport: function(platform, schedule) {
                const schedules = {
                    daily: 24 * 60 * 60 * 1000,
                    weekly: 7 * 24 * 60 * 60 * 1000,
                    monthly: 30 * 24 * 60 * 60 * 1000
                };
                
                const interval = schedules[schedule];
                if (!interval) {
                    throw new Error(`Invalid schedule: ${schedule}`);
                }
                
                // Clear existing schedule if any
                if (this.exportIntervals && this.exportIntervals[platform]) {
                    clearInterval(this.exportIntervals[platform]);
                }
                
                this.exportIntervals = this.exportIntervals || {};
                this.exportIntervals[platform] = setInterval(() => {
                    this.exportPlatformData(platform, 'csv', {
                        start: new Date(Date.now() - interval),
                        end: new Date()
                    });
                }, interval);
                
                showToast(`Auto-export scheduled for ${platform} (${schedule})`, 'success');
            },
            
            getSampleFacebookData: async function() {
                return [
                    { date: '2024-01', likes: 2450, comments: 120, shares: 45 },
                    { date: '2024-02', likes: 2670, comments: 145, shares: 52 }
                ];
            },
            
            getSampleInstagramData: async function() {
                return [
                    { date: '2024-01', likes: 3120, comments: 230, saves: 450 },
                    { date: '2024-02', likes: 3450, comments: 265, saves: 520 }
                ];
            },
            
            getSampleTwitterData: async function() {
                return [
                    { date: '2024-01', retweets: 450, likes: 890, replies: 120 },
                    { date: '2024-02', retweets: 520, likes: 950, replies: 145 }
                ];
            }
        };

        // 12. Real-time Notification System
        const REALTIME_MANAGER = {
            socket: null,
            reconnectAttempts: 0,
            maxReconnectAttempts: 5,
            
            connectWebSocket: function() {
                if (this.socket && this.socket.readyState === WebSocket.OPEN) {
                    return; // Already connected
                }
                
                // In production, use your WebSocket server URL
                const wsUrl = 'wss://your-server.com/social-websocket';
                
                try {
                    this.socket = new WebSocket(wsUrl);
                    
                    this.socket.onopen = () => {
                        showToast('Real-time updates connected', 'success');
                        this.reconnectAttempts = 0;
                        this.subscribeToPlatforms();
                    };
                    
                    this.socket.onmessage = (event) => {
                        try {
                            const data = JSON.parse(event.data);
                            this.handleRealtimeUpdate(data);
                        } catch (error) {
                            console.error('Failed to parse WebSocket message:', error);
                        }
                    };
                    
                    this.socket.onclose = () => {
                        showToast('Real-time updates disconnected', 'warning');
                        this.attemptReconnect();
                    };
                    
                    this.socket.onerror = (error) => {
                        console.error('WebSocket error:', error);
                    };
                    
                } catch (error) {
                    console.error('Failed to connect WebSocket:', error);
                    this.attemptReconnect();
                }
            },
            
            subscribeToPlatforms: function() {
                if (!this.socket || this.socket.readyState !== WebSocket.OPEN) {
                    return;
                }
                
                const platforms = Object.keys(socialData).filter(platform => 
                    socialData[platform].api.connected
                );
                
                platforms.forEach(platform => {
                    const subscription = {
                        type: 'subscribe',
                        platform: platform,
                        userId: currentUser?.id,
                        timestamp: new Date().toISOString()
                    };
                    
                    this.socket.send(JSON.stringify(subscription));
                });
            },
            
            handleRealtimeUpdate: function(data) {
                if (!data || !data.type) return;
                
                switch(data.type) {
                    case 'new_post':
                        this.updateUI('posts', data);
                        break;
                    case 'new_engagement':
                        this.updateUI('engagement', data);
                        break;
                    case 'new_follower':
                        this.updateUI('followers', data);
                        break;
                    case 'revenue_update':
                        this.updateUI('revenue', data);
                        break;
                    case 'system_alert':
                        this.showSystemAlert(data);
                        break;
                    case 'api_status':
                        this.handleAPIStatusUpdate(data);
                        break;
                }
                
                // Also trigger webhook simulation for demo
                if (data.platform && data.type.startsWith('new_')) {
                    WEBHOOK_MANAGER.handleWebhookEvent(data.platform, data);
                }
            },
            
            updateUI: function(type, data) {
                // Update the UI based on the real-time data
                const platform = data.platform;
                
                switch(type) {
                    case 'posts':
                        // Update posts counter
                        if (currentPage === platform) {
                            // Refresh posts table
                            if (platform === 'facebook') loadFacebookPosts();
                            if (platform === 'instagram') loadInstagramPosts();
                            if (platform === 'twitter') loadTwitterPosts();
                        }
                        break;
                        
                    case 'followers':
                        // Update followers count
                        const followerChange = data.data?.count || 1;
                        socialData[platform].stats.followers += followerChange;
                        
                        if (currentPage === 'overview' || currentPage === platform) {
                            navigateToPage(currentPage);
                        }
                        break;
                        
                    case 'engagement':
                        // Update engagement metrics
                        const engagement = data.data?.engagement || 0;
                        socialData[platform].stats.engagement = 
                            ((socialData[platform].stats.engagement + engagement) / 2).toFixed(1);
                        break;
                        
                    case 'revenue':
                        // Update revenue
                        const revenue = data.data?.amount || 0;
                        socialData[platform].stats.revenue += revenue;
                        
                        if (currentPage === 'revenue' || currentPage === platform) {
                            navigateToPage(currentPage);
                        }
                        break;
                }
                
                // Show notification
                this.showRealtimeNotification(data);
            },
            
            showSystemAlert: function(data) {
                const alert = {
                    id: `alert_${Date.now()}`,
                    type: 'system',
                    title: data.title || 'System Alert',
                    message: data.message || 'System notification',
                    severity: data.severity || 'info',
                    timestamp: new Date().toISOString()
                };
                
                // Store alert
                const alerts = JSON.parse(localStorage.getItem('mehan_alerts') || '[]');
                alerts.unshift(alert);
                localStorage.setItem('mehan_alerts', JSON.stringify(alerts.slice(0, 20)));
                
                // Show toast
                const toastType = alert.severity === 'error' ? 'error' : 
                                 alert.severity === 'warning' ? 'warning' : 'info';
                
                showToast(`${alert.title}: ${alert.message}`, toastType);
            },
            
            handleAPIStatusUpdate: function(data) {
                const platform = data.platform;
                const status = data.status;
                
                CONNECTIVITY_MONITOR.updateStatus(platform, {
                    connected: status === 'connected',
                    lastChecked: new Date(),
                    message: data.message
                });
                
                updatePlatformBadge(platform);
                
                if (status !== 'connected') {
                    showToast(`${platform} API ${status}: ${data.message}`, 'warning');
                }
            },
            
            showRealtimeNotification: function(data) {
                const notification = {
                    id: `realtime_${Date.now()}`,
                    platform: data.platform,
                    type: data.type,
                    title: this.getNotificationTitle(data),
                    message: this.getNotificationMessage(data),
                    timestamp: new Date().toISOString(),
                    read: false
                };
                
                // Store notification
                const notifications = JSON.parse(localStorage.getItem('mehan_notifications') || '[]');
                notifications.unshift(notification);
                localStorage.setItem('mehan_notifications', JSON.stringify(notifications.slice(0, 20)));
                
                // Update notification badge
                updateNotificationBadge();
            },
            
            getNotificationTitle: function(data) {
                const titles = {
                    'new_post': 'New Post',
                    'new_engagement': 'Engagement Spike',
                    'new_follower': 'New Followers',
                    'revenue_update': 'Revenue Update'
                };
                
                const platform = data.platform.charAt(0).toUpperCase() + data.platform.slice(1);
                return `${platform}: ${titles[data.type] || 'Update'}`;
            },
            
            getNotificationMessage: function(data) {
                if (data.data?.count) return `${data.data.count} new followers`;
                if (data.data?.amount) return `$${data.data.amount} revenue generated`;
                if (data.type === 'new_post') return 'New content published';
                if (data.type === 'new_engagement') return 'High engagement detected';
                return 'New update received';
            },
            
            attemptReconnect: function() {
                if (this.reconnectAttempts >= this.maxReconnectAttempts) {
                    showToast('Real-time updates unavailable. Using polling mode.', 'warning');
                    return;
                }
                
                this.reconnectAttempts++;
                const delay = Math.min(1000 * Math.pow(2, this.reconnectAttempts), 30000);
                
                setTimeout(() => {
                    showToast('Reconnecting to real-time updates...', 'info');
                    this.connectWebSocket();
                }, delay);
            },
            
            disconnect: function() {
                if (this.socket) {
                    this.socket.close();
                    this.socket = null;
                }
            }
        };

        // ==================== UPDATED FUNCTIONS ====================

        // Replace existing fetch functions with enhanced versions
        async function fetchPlatformData(platform) {
            if (!socialData[platform].api.connected) {
                showToast(`${platform} is not connected`, 'warning');
                return;
            }
            
            if (!RATE_LIMIT_MANAGER.checkRateLimit(platform)) {
                return;
            }
            
            showToast(`Fetching ${platform} data...`, 'info');
            
            try {
                const tokens = TOKEN_MANAGER.getTokens(platform);
                if (!tokens) {
                    throw new Error('Not authenticated');
                }
                
                let data;
                
                switch(platform) {
                    case 'facebook':
                        data = await fetchFacebookAPIData(tokens);
                        break;
                    case 'instagram':
                        data = await fetchInstagramAPIData(tokens);
                        break;
                    case 'twitter':
                        data = await fetchTwitterAPIData(tokens);
                        break;
                    default:
                        throw new Error(`Unsupported platform: ${platform}`);
                }
                
                // Validate data
                DATA_VALIDATOR.validateResponse(platform, data);
                
                // Process and update social data
                await processPlatformData(platform, data);
                
                // Update last sync
                socialData[platform].api.lastSync = new Date();
                
                // Update UI
                updatePlatformBadge(platform);
                
                if (currentPage === platform || currentPage === 'overview') {
                    navigateToPage(currentPage);
                }
                
                showToast(`${platform} data updated successfully!`, 'success');
                
                // Log successful fetch
                SECURITY_MANAGER.auditLog('data_fetch', {
                    platform: platform,
                    success: true
                });
                
            } catch (error) {
                console.error(`Failed to fetch ${platform} data:`, error);
                DATA_VALIDATOR.handleAPIError(platform, error);
                
                // Log failed fetch
                SECURITY_MANAGER.auditLog('data_fetch', {
                    platform: platform,
                    success: false,
                    error: error.message
                });
            }
        }

        async function fetchFacebookAPIData(tokens) {
            // Use batch processing for efficiency
            const requests = [
                {
                    name: 'pages',
                    endpoint: API_CONFIG.facebook.endpoints.page,
                    params: { access_token: tokens.access_token }
                },
                {
                    name: 'insights',
                    endpoint: API_CONFIG.facebook.endpoints.insights.replace('{page_id}', 'me'),
                    params: { 
                        access_token: tokens.access_token,
                        metric: 'page_fans,page_engaged_users,page_impressions'
                    }
                }
            ];
            
            return await BATCH_PROCESSOR.batchRequests('facebook', requests);
        }

        async function fetchInstagramAPIData(tokens) {
            // Similar batch processing for Instagram
            const requests = [
                {
                    name: 'user',
                    endpoint: API_CONFIG.instagram.endpoints.user,
                    params: { access_token: tokens.access_token }
                }
            ];
            
            return await BATCH_PROCESSOR.batchRequests('instagram', requests);
        }

        async function fetchTwitterAPIData(tokens) {
            const requests = [
                {
                    name: 'user',
                    endpoint: API_CONFIG.twitter.endpoints.user,
                    params: { 'user.fields': 'public_metrics' }
                },
                {
                    name: 'tweets',
                    endpoint: API_CONFIG.twitter.endpoints.tweets.replace('{user_id}', 'me'),
                    params: { 
                        max_results: 10,
                        'tweet.fields': 'public_metrics,created_at'
                    }
                }
            ];
            
            return await BATCH_PROCESSOR.batchRequests('twitter', requests);
        }

        async function processPlatformData(platform, apiData) {
            switch(platform) {
                case 'facebook':
                    if (apiData.pages?.data?.[0]) {
                        const page = apiData.pages.data[0];
                        socialData.facebook.stats = {
                            followers: page.fan_count || 0,
                            engagement: calculateEngagementRate(apiData.insights),
                            reach: page.insights?.data?.[0]?.values?.[0]?.value || 0,
                            revenue: calculateRevenue('facebook', apiData)
                        };
                    }
                    break;
                    
                case 'instagram':
                    if (apiData.user?.data) {
                        const user = apiData.user.data;
                        socialData.instagram.stats = {
                            followers: user.followers_count || 0,
                            engagement: calculateEngagementRate(apiData.insights),
                            reach: user.media_count || 0,
                            revenue: calculateRevenue('instagram', apiData)
                        };
                    }
                    break;
                    
                case 'twitter':
                    if (apiData.user?.data) {
                        const user = apiData.user.data;
                        socialData.twitter.stats = {
                            followers: user.public_metrics?.followers_count || 0,
                            engagement: calculateTwitterEngagement(apiData.tweets),
                            reach: user.public_metrics?.tweet_count || 0,
                            revenue: calculateRevenue('twitter', apiData)
                        };
                    }
                    break;
            }
        }

        function calculateEngagementRate(insightsData) {
            if (!insightsData?.data) return 0;
            
            // Simplified calculation for demo
            const engaged = insightsData.data.find(d => d.name === 'page_engaged_users')?.values?.[0]?.value || 0;
            const total = insightsData.data.find(d => d.name === 'page_impressions')?.values?.[0]?.value || 1;
            
            return ((engaged / total) * 100).toFixed(1);
        }

        function calculateTwitterEngagement(tweetsData) {
            if (!tweetsData?.data) return 0;
            
            let totalEngagement = 0;
            tweetsData.data.forEach(tweet => {
                const metrics = tweet.public_metrics || {};
                totalEngagement += (metrics.like_count || 0) + (metrics.retweet_count || 0) * 2;
            });
            
            return tweetsData.data.length > 0 ? (totalEngagement / tweetsData.data.length).toFixed(1) : 0;
        }

        function calculateRevenue(platform, apiData) {
            // Simplified revenue calculation for demo
            const baseRevenue = {
                facebook: 8950,
                instagram: 12450,
                twitter: 3450
            };
            
            // Add some random variation
            const variation = Math.random() * 0.2 - 0.1; // 10%
            return Math.floor(baseRevenue[platform] * (1 + variation));
        }

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            initializeAuth();
            checkExistingSession();
            setupEventListeners();
        });

        // Initialize Authentication
        function initializeAuth() {
            showLoginPage();
        }

        // Show Login Page
        function showLoginPage() {
            document.getElementById('loginPage').style.display = 'grid';
            document.getElementById('signupPage').style.display = 'none';
            document.getElementById('authContainer').style.display = 'flex';
            document.getElementById('dashboardContainer').style.display = 'none';
        }

        // Show Signup Page
        function showSignupPage() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('signupPage').style.display = 'grid';
        }

        // Show Dashboard
        function showDashboard() {
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('dashboardContainer').style.display = 'flex';
            
            // Load dashboard content
            loadDashboard();
            applyTheme();
            
            // Start auto-sync
            startAutoSync();
            
            // Initialize API systems
            setTimeout(() => {
                initializeAPISystems();
            }, 1000);
        }

        // Setup Event Listeners
        function setupEventListeners() {
            // Auth Navigation
            document.getElementById('showSignup').addEventListener('click', function(e) {
                e.preventDefault();
                showSignupPage();
            });

            document.getElementById('showLogin').addEventListener('click', function(e) {
                e.preventDefault();
                showLoginPage();
            });

            // Password Toggles
            document.getElementById('toggleLoginPassword').addEventListener('click', function() {
                togglePasswordVisibility('loginPassword', this);
            });

            document.getElementById('toggleSignupPassword').addEventListener('click', function() {
                togglePasswordVisibility('signupPassword', this);
            });

            // Login Form
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleLogin();
            });

            // Signup Form
            document.getElementById('signupForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleSignup();
            });

            // Password Strength
            document.getElementById('signupPassword').addEventListener('input', function() {
                checkPasswordStrength(this.value);
            });

            // Dashboard Navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.dataset.page;
                    navigateToPage(page);
                });
            });

            // Theme Toggle
            document.getElementById('themeToggle').addEventListener('click', toggleTheme);

            // Mobile Menu
            document.getElementById('mobileMenuBtn').addEventListener('click', toggleMobileMenu);

            // Quick Actions
            document.getElementById('syncBtn').addEventListener('click', syncAllPlatforms);
            document.getElementById('notificationBtn').addEventListener('click', toggleNotifications);
            document.getElementById('helpBtn').addEventListener('click', showHelp);
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);

            // Search
            document.getElementById('searchInput').addEventListener('input', handleSearch);
        }

        // Handle Login
        function handleLogin() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;
            const rememberMe = document.getElementById('rememberMe').checked;

            if (USERS[email] && password === USERS[email].password) {
                const role = USERS[email].role;
                currentUser = {
                    name: role === 'admin' ? 'Alex Morgan' : role === 'analyst' ? 'Sarah Chen' : 'Michael Brown',
                    email: email,
                    role: role,
                    plan: role === 'admin' ? 'Enterprise' : role === 'analyst' ? 'Professional' : 'Basic',
                    avatar: role === 'admin' ? 'https://randomuser.me/api/portraits/men/32.jpg' : 
                            role === 'analyst' ? 'https://randomuser.me/api/portraits/women/44.jpg' : 
                            'https://randomuser.me/api/portraits/men/22.jpg'
                };

                if (rememberMe) {
                    localStorage.setItem('mehan_user', JSON.stringify(currentUser));
                }

                showDashboard();
                showToast(`Welcome back, ${currentUser.name}!`, 'success');
            } else {
                showToast('Invalid email or password', 'error');
            }
        }

        // Handle Signup
        function handleSignup() {
            const name = document.getElementById('signupName').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const company = document.getElementById('signupCompany').value.trim();
            const role = document.getElementById('signupRole').value;
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;
            const termsAgreed = document.getElementById('termsAgreement').checked;
            const connectSocial = document.getElementById('connectSocial').checked;

            if (!name || !email || !company || !role || !password || !confirmPassword) {
                showToast('Please fill in all required fields', 'error');
                return;
            }

            if (password !== confirmPassword) {
                showToast('Passwords do not match', 'error');
                return;
            }

            if (!termsAgreed) {
                showToast('Please agree to the Terms of Service', 'error');
                return;
            }

            // Simulate API call
            showToast('Account created successfully! Setting up social media connections...', 'success');
            
            setTimeout(() => {
                currentUser = {
                    name: name,
                    email: email,
                    role: 'viewer',
                    plan: 'Basic',
                    avatar: 'https://randomuser.me/api/portraits/men/22.jpg'
                };
                
                if (connectSocial) {
                    // Simulate connecting social media
                    simulateSocialConnections();
                }
                
                showDashboard();
                showToast('Dashboard ready! Social media connections established.', 'info');
            }, 2000);
        }

        // Toggle Password Visibility
        function togglePasswordVisibility(inputId, iconElement) {
            const input = document.getElementById(inputId);
            if (input.type === 'password') {
                input.type = 'text';
                iconElement.classList.remove('fa-eye');
                iconElement.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                iconElement.classList.remove('fa-eye-slash');
                iconElement.classList.add('fa-eye');
            }
        }

        // Check Password Strength
        function checkPasswordStrength(password) {
            let strength = 0;
            const strengthBar = document.getElementById('passwordStrength');
            
            if (password.length >= 8) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/[0-9]/.test(password)) strength++;
            if (/[^A-Za-z0-9]/.test(password)) strength++;
            
            strengthBar.className = 'password-strength-bar';
            strengthBar.classList.add(`strength-${Math.min(strength, 4)}`);
        }

        // Check Existing Session
        function checkExistingSession() {
            const savedUser = localStorage.getItem('mehan_user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showDashboard();
            }
        }

        // Load Dashboard
        function loadDashboard() {
            // Update user info
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userRole').textContent = currentUser.role + ' - Social Media';
            document.getElementById('userPlan').textContent = currentUser.plan + ' Plan';
            document.getElementById('userAvatar').src = currentUser.avatar;
            
            // Load current page
            navigateToPage(currentPage);
        }

        // Navigate to Page
        function navigateToPage(page) {
            currentPage = page;
            
            // Update active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.dataset.page === page) {
                    link.classList.add('active');
                }
            });
            
            // Load page content
            loadPageContent(page);
            
            // Close mobile menu on navigation
            document.getElementById('sidebar').classList.remove('active');
        }

        // Load Page Content
        function loadPageContent(page) {
            const contentContainer = document.getElementById('dashboardContent');
            
            // Clear existing charts
            Object.values(chartInstances).forEach(chart => {
                if (chart && chart.destroy) {
                    chart.destroy();
                }
            });
            chartInstances = {};
            
            switch(page) {
                case 'overview':
                    loadOverviewPage(contentContainer);
                    break;
                case 'platforms':
                    loadPlatformsPage(contentContainer);
                    break;
                case 'facebook':
                    loadFacebookPage(contentContainer);
                    break;
                case 'instagram':
                    loadInstagramPage(contentContainer);
                    break;
                case 'twitter':
                    loadTwitterPage(contentContainer);
                    break;
                case 'analytics':
                    loadAnalyticsPage(contentContainer);
                    break;
                case 'revenue':
                    loadRevenuePage(contentContainer);
                    break;
                case 'reports':
                    loadReportsPage(contentContainer);
                    break;
                case 'comparison':
                    loadComparisonPage(contentContainer);
                    break;
                case 'api':
                    loadAPIPage(contentContainer);
                    break;
                default:
                    loadOverviewPage(contentContainer);
            }
        }

        // Load Overview Page
        function loadOverviewPage(container) {
            document.getElementById('pageTitle').textContent = 'Social Media Dashboard';
            document.getElementById('pageSubtitle').textContent = 'Real-time analytics from Facebook, Instagram, and Twitter';
            
            container.innerHTML = `
                <div class="charts-section mb-40">
                    <div class="section-header">
                        <div>
                            <h2>Platform Performance</h2>
                            <p>Real-time metrics across all connected platforms</p>
                        </div>
                        <div class="section-actions">
                            <button class="section-btn" onclick="syncAllPlatforms()">
                                <i class="fas fa-sync-alt"></i> Sync Now
                            </button>
                            <button class="section-btn primary" onclick="exportAllData()">
                                <i class="fas fa-download"></i> Export Data
                            </button>
                        </div>
                    </div>
                    
                    <div class="charts-grid">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <h3>Audience Growth</h3>
                                    <p>Total followers/subscribers across platforms</p>
                                </div>
                            </div>
                            <div class="chart-viz" id="chart-audience"></div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <h3>Revenue Trends</h3>
                                    <p>Monthly revenue from social media platforms</p>
                                </div>
                            </div>
                            <div class="chart-viz" id="chart-revenue"></div>
                        </div>
                    </div>
                </div>
                
                <div class="insights-grid mb-40">
                    <div class="insight-card">
                        <div class="insight-header">
                            <h3>Top Performing Platform</h3>
                            <div class="insight-trend positive">
                                <i class="fas fa-arrow-up"></i> +24.7%
                            </div>
                        </div>
                        <div style="display: flex; align-items: center; gap: 15px; margin-top: 20px;">
                            <div class="platform-icon instagram">
                                <i class="fab fa-instagram"></i>
                            </div>
                            <div>
                                <h2 style="font-size: 32px; margin-bottom: 5px;">Instagram</h2>
                                <p style="color: var(--text-secondary);">Highest engagement & revenue</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="insight-card">
                        <div class="insight-header">
                            <h3>Total Social Revenue</h3>
                            <div class="insight-trend positive">
                                <i class="fas fa-arrow-up"></i> +18.5%
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <h2 style="font-size: 42px; color: var(--success); margin-bottom: 10px;">$24,850</h2>
                            <p style="color: var(--text-secondary);">Monthly revenue from all platforms</p>
                            <div class="platform-progress">
                                <div class="platform-progress-bar progress-instagram" style="width: 45%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="platforms-grid mb-40">
                    <div class="section-header">
                        <h2>Connected Platforms</h2>
                        <p>Live data from your social media accounts</p>
                    </div>
                    <div class="stats-grid" id="platformCards"></div>
                </div>
                
                <div class="activity-feed">
                    <div class="section-header">
                        <h2>Recent Social Activity</h2>
                        <button class="section-btn" onclick="viewAllActivity()">
                            <i class="fas fa-history"></i> View All
                        </button>
                    </div>
                    
                    <ul class="activity-list" id="activityList"></ul>
                </div>
            `;
            
            // Load platform cards
            updatePlatformCards();
            
            // Load activities
            loadSocialActivities();
            
            // Initialize charts
            setTimeout(() => {
                initializeSocialCharts();
            }, 100);
        }

        // Load Platforms Page
        function loadPlatformsPage(container) {
            document.getElementById('pageTitle').textContent = 'Platform Management';
            document.getElementById('pageSubtitle').textContent = 'Manage and connect your social media platforms';
            
            container.innerHTML = `
                <div class="section-header mb-40">
                    <div>
                        <h2>Social Media Platforms</h2>
                        <p>Connect and manage your social media accounts</p>
                    </div>
                    <div class="section-actions">
                        <button class="section-btn primary" onclick="connectAllPlatforms()">
                            <i class="fas fa-plug"></i> Connect All
                        </button>
                    </div>
                </div>
                
                <div class="stats-grid mb-40" id="platformManagementCards"></div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <div class="chart-title">
                            <h3>Data Sync Status</h3>
                            <p>Last synchronization times for each platform</p>
                        </div>
                    </div>
                    <div class="chart-viz" id="chart-sync"></div>
                </div>
            `;
            
            // Load platform management cards
            loadPlatformManagementCards();
            
            // Initialize sync chart
            setTimeout(() => {
                initializeSyncChart();
            }, 100);
        }

        // Load Facebook Page
        function loadFacebookPage(container) {
            const platform = socialData.facebook;
            document.getElementById('pageTitle').textContent = 'Facebook Analytics';
            document.getElementById('pageSubtitle').textContent = 'Detailed insights from your Facebook pages and ads';
            
            container.innerHTML = `
                <div class="platform-card facebook">
                    <div class="platform-header">
                        <div class="platform-icon facebook">
                            <i class="fab fa-facebook"></i>
                        </div>
                        <div class="platform-info">
                            <h4>Facebook Business</h4>
                            <p>Connected: ${platform.api.connected ? ' Live' : ' Disconnected'}</p>
                            <div class="api-status ${platform.api.connected ? 'connected' : 'disconnected'}">
                                <i class="fas fa-circle"></i>
                                ${platform.api.connected ? 'API Connected' : 'API Disconnected'}
                            </div>
                        </div>
                    </div>
                    
                    <div class="platform-stats">
                        <div class="platform-stat">
                            <h3>${formatNumber(platform.stats.followers)}</h3>
                            <p>Page Likes</p>
                        </div>
                        <div class="platform-stat">
                            <h3>${platform.stats.engagement}%</h3>
                            <p>Engagement Rate</p>
                        </div>
                        <div class="platform-stat">
                            <h3>${formatNumber(platform.stats.reach)}</h3>
                            <p>Total Reach</p>
                        </div>
                        <div class="platform-stat">
                            <h3>$${formatNumber(platform.stats.revenue)}</h3>
                            <p>Monthly Revenue</p>
                        </div>
                        <div class="platform-stat">
                            <h3>${platform.api.lastSync ? formatTime(platform.api.lastSync) : 'Never'}</h3>
                            <p>Last Synced</p>
                        </div>
                        <div class="platform-stat">
                            <h3>24/7</h3>
                            <p>Monitoring</p>
                        </div>
                    </div>
                    
                    <div class="platform-actions">
                        <button class="platform-btn" onclick="fetchPlatformData('facebook')">
                            <i class="fas fa-sync"></i> Refresh Data
                        </button>
                        <button class="platform-btn" onclick="connectPlatform('facebook')">
                            <i class="fas fa-plug"></i> ${platform.api.connected ? 'Reconnect' : 'Connect'}
                        </button>
                        <button class="platform-btn" onclick="showFacebookReports()">
                            <i class="fas fa-chart-bar"></i> Reports
                        </button>
                    </div>
                </div>
                
                <div class="charts-section mt-40">
                    <div class="charts-grid">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <h3>Facebook Engagement</h3>
                                    <p>Post interactions and reactions</p>
                                </div>
                            </div>
                            <div class="chart-viz" id="chart-facebook-engagement"></div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <h3>Ad Performance</h3>
                                    <p>Facebook ad revenue and ROI</p>
                                </div>
                            </div>
                            <div class="chart-viz" id="chart-facebook-ads"></div>
                        </div>
                    </div>
                </div>
                
                <div class="data-table mt-40">
                    <div class="data-table-header">
                        <div>
                            <h3>Recent Facebook Posts</h3>
                            <p>Performance metrics for latest posts</p>
                        </div>
                        <button class="section-btn" onclick="loadMoreFacebookPosts()">
                            <i class="fas fa-redo"></i> Load More
                        </button>
                    </div>
                    <div class="data-table-content">
                        <table id="facebookPostsTable">
                            <thead>
                                <tr>
                                    <th>Post</th>
                                    <th>Type</th>
                                    <th>Reach</th>
                                    <th>Engagement</th>
                                    <th>Revenue</th>
                                    <th>Time</th>
                                </tr>
                            </thead>
                            <tbody id="facebookPostsBody">
                                <!-- Posts loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            // Load Facebook posts
            loadFacebookPosts();
            
            // Initialize Facebook charts
            setTimeout(() => {
                initializeFacebookCharts();
            }, 100);
        }

        // Load Instagram Page
        function loadInstagramPage(container) {
            const platform = socialData.instagram;
            document.getElementById('pageTitle').textContent = 'Instagram Analytics';
            document.getElementById('pageSubtitle').textContent = 'Instagram insights, stories, and shopping analytics';
            
            container.innerHTML = `
                <div class="platform-card instagram">
                    <div class="platform-header">
                        <div class="platform-icon instagram">
                            <i class="fab fa-instagram"></i>
                        </div>
                        <div class="platform-info">
                            <h4>Instagram Business</h4>
                            <p>Connected: ${platform.api.connected ? ' Live' : ' Disconnected'}</p>
                            <div class="api-status ${platform.api.connected ? 'connected' : 'disconnected'}">
                                <i class="fas fa-circle"></i>
                                ${platform.api.connected ? 'API Connected' : 'API Disconnected'}
                            </div>
                        </div>
                    </div>
                    
                    <div class="platform-stats">
                        <div class="platform-stat">
                            <h3>${formatNumber(platform.stats.followers)}</h3>
                            <p>Followers</p>
                        </div>
                        <div class="platform-stat">
                            <h3>${platform.stats.engagement}%</h3>
                            <p>Engagement Rate</p>
                        </div>
                        <div class="platform-stat">
                            <h3>${formatNumber(platform.stats.reach)}</h3>
                            <p>Impressions</p>
                        </div>
                        <div class="platform-stat">
                            <h3>$${formatNumber(platform.stats.revenue)}</h3>
                            <p>Monthly Revenue</p>
                        </div>
                        <div class="platform-stat">
                            <h3>${platform.api.lastSync ? formatTime(platform.api.lastSync) : 'Never'}</h3>
                            <p>Last Synced</p>
                        </div>
                        <div class="platform-stat">
                            <h3>Shop Active</h3>
                            <p>E-commerce</p>
                        </div>
                    </div>
                    
                    <div class="platform-actions">
                        <button class="platform-btn" onclick="fetchPlatformData('instagram')">
                            <i class="fas fa-sync"></i> Refresh Data
                        </button>
                        <button class="platform-btn" onclick="connectPlatform('instagram')">
                            <i class="fas fa-plug"></i> ${platform.api.connected ? 'Reconnect' : 'Connect'}
                        </button>
                        <button class="platform-btn" onclick="showInstagramReports()">
                            <i class="fas fa-shopping-bag"></i> Shopping
                        </button>
                    </div>
                </div>
                
                <div class="charts-section mt-40">
                    <div class="charts-grid">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <h3>Instagram Engagement</h3>
                                    <p>Likes, comments, and shares</p>
                                </div>
                            </div>
                            <div class="chart-viz" id="chart-instagram-engagement"></div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <h3>Story Performance</h3>
                                    <p>Instagram stories reach and taps</p>
                                </div>
                            </div>
                            <div class="chart-viz" id="chart-instagram-stories"></div>
                        </div>
                    </div>
                </div>
                
                <div class="data-table mt-40">
                    <div class="data-table-header">
                        <div>
                            <h3>Recent Instagram Posts</h3>
                            <p>Performance metrics for latest posts</p>
                        </div>
                        <button class="section-btn" onclick="loadMoreInstagramPosts()">
                            <i class="fas fa-redo"></i> Load More
                        </button>
                    </div>
                    <div class="data-table-content">
                        <table id="instagramPostsTable">
                            <thead>
                                <tr>
                                    <th>Post</th>
                                    <th>Type</th>
                                    <th>Likes</th>
                                    <th>Comments</th>
                                    <th>Revenue</th>
                                    <th>Time</th>
                                </tr>
                            </thead>
                            <tbody id="instagramPostsBody">
                                <!-- Posts loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            // Load Instagram posts
            loadInstagramPosts();
            
            // Initialize Instagram charts
            setTimeout(() => {
                initializeInstagramCharts();
            }, 100);
        }

        // Load Twitter Page
        function loadTwitterPage(container) {
            const platform = socialData.twitter;
            document.getElementById('pageTitle').textContent = 'Twitter Analytics';
            document.getElementById('pageSubtitle').textContent = 'Twitter performance, trends, and monetization';
            
            container.innerHTML = `
                <div class="platform-card twitter">
                    <div class="platform-header">
                        <div class="platform-icon twitter">
                            <i class="fab fa-twitter"></i>
                        </div>
                        <div class="platform-info">
                            <h4>Twitter Analytics</h4>
                            <p>Connected: ${platform.api.connected ? ' Live' : ' Disconnected'}</p>
                            <div class="api-status ${platform.api.connected ? 'connected' : 'disconnected'}">
                                <i class="fas fa-circle"></i>
                                ${platform.api.connected ? 'API Connected' : 'API Disconnected'}
                            </div>
                        </div>
                    </div>
                    
                    <div class="platform-stats">
                        <div class="platform-stat">
                            <h3>${formatNumber(platform.stats.followers)}</h3>
                            <p>Followers</p>
                        </div>
                        <div class="platform-stat">
                            <h3>${platform.stats.engagement}%</h3>
                            <p>Engagement Rate</p>
                        </div>
                        <div class="platform-stat">
                            <h3>${formatNumber(platform.stats.reach)}</h3>
                            <p>Impressions</p>
                        </div>
                        <div class="platform-stat">
                            <h3>$${formatNumber(platform.stats.revenue)}</h3>
                            <p>Monthly Revenue</p>
                        </div>
                        <div class="platform-stat">
                            <h3>${platform.api.lastSync ? formatTime(platform.api.lastSync) : 'Never'}</h3>
                            <p>Last Synced</p>
                        </div>
                        <div class="platform-stat">
                            <h3>Trending</h3>
                            <p>#SocialMedia</p>
                        </div>
                    </div>
                    
                    <div class="platform-actions">
                        <button class="platform-btn" onclick="fetchPlatformData('twitter')">
                            <i class="fas fa-sync"></i> Refresh Data
                        </button>
                        <button class="platform-btn" onclick="connectPlatform('twitter')">
                            <i class="fas fa-plug"></i> ${platform.api.connected ? 'Reconnect' : 'Connect'}
                        </button>
                        <button class="platform-btn" onclick="showTwitterReports()">
                            <i class="fas fa-hashtag"></i> Trends
                        </button>
                    </div>
                </div>
                
                <div class="charts-section mt-40">
                    <div class="charts-grid">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <h3>Twitter Engagement</h3>
                                    <p>Retweets, likes, and replies</p>
                                </div>
                            </div>
                            <div class="chart-viz" id="chart-twitter-engagement"></div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <h3>Follower Growth</h3>
                                    <p>Daily follower increase</p>
                                </div>
                            </div>
                            <div class="chart-viz" id="chart-twitter-growth"></div>
                        </div>
                    </div>
                </div>
                
                <div class="data-table mt-40">
                    <div class="data-table-header">
                        <div>
                            <h3>Recent Tweets</h3>
                            <p>Performance metrics for latest tweets</p>
                        </div>
                        <button class="section-btn" onclick="loadMoreTwitterPosts()">
                            <i class="fas fa-redo"></i> Load More
                        </button>
                    </div>
                    <div class="data-table-content">
                        <table id="twitterPostsTable">
                            <thead>
                                <tr>
                                    <th>Tweet</th>
                                    <th>Type</th>
                                    <th>Retweets</th>
                                    <th>Likes</th>
                                    <th>Revenue</th>
                                    <th>Time</th>
                                </tr>
                            </thead>
                            <tbody id="twitterPostsBody">
                                <!-- Tweets loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            // Load Twitter posts
            loadTwitterPosts();
            
            // Initialize Twitter charts
            setTimeout(() => {
                initializeTwitterCharts();
            }, 100);
        }

        // Load Analytics Page
        function loadAnalyticsPage(container) {
            document.getElementById('pageTitle').textContent = 'Advanced Analytics';
            document.getElementById('pageSubtitle').textContent = 'Cross-platform analytics and insights';
            
            container.innerHTML = `
                <div class="charts-section">
                    <div class="section-header">
                        <div>
                            <h2>Cross-Platform Analytics</h2>
                            <p>Comparative analysis across all social media platforms</p>
                        </div>
                        <div class="section-actions">
                            <button class="section-btn" onclick="generateAnalyticsReport()">
                                <i class="fas fa-file-export"></i> Export Report
                            </button>
                            <button class="section-btn primary" onclick="refreshAnalytics()">
                                <i class="fas fa-sync"></i> Refresh
                            </button>
                        </div>
                    </div>
                    
                    <div class="charts-grid">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <h3>Platform Comparison</h3>
                                    <p>Engagement rates across platforms</p>
                                </div>
                            </div>
                            <div class="chart-viz" id="chart-platform-comparison"></div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <h3>Revenue Distribution</h3>
                                    <p>Revenue share by platform</p>
                                </div>
                            </div>
                            <div class="chart-viz" id="chart-revenue-distribution"></div>
                        </div>
                    </div>
                </div>
                
                <div class="insights-grid mt-40">
                    <div class="insight-card">
                        <div class="insight-header">
                            <h3>Best Time to Post</h3>
                            <div class="insight-trend positive">
                                <i class="fas fa-clock"></i> Optimized
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <h2 style="font-size: 24px; margin-bottom: 10px;">2:00 PM - 4:00 PM</h2>
                            <p style="color: var(--text-secondary);">Peak engagement time across all platforms</p>
                            <div style="display: flex; gap: 10px; margin-top: 15px;">
                                <span style="padding: 5px 10px; background: var(--facebook); color: white; border-radius: 4px;">Facebook</span>
                                <span style="padding: 5px 10px; background: var(--instagram); color: white; border-radius: 4px;">Instagram</span>
                                <span style="padding: 5px 10px; background: var(--twitter); color: white; border-radius: 4px;">Twitter</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="insight-card">
                        <div class="insight-header">
                            <h3>Top Content Type</h3>
                            <div class="insight-trend positive">
                                <i class="fas fa-video"></i> +42%
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <h2 style="font-size: 24px; margin-bottom: 10px;">Video Content</h2>
                            <p style="color: var(--text-secondary);">Highest engagement and revenue generator</p>
                            <div class="platform-progress" style="margin-top: 15px;">
                                <div class="platform-progress-bar progress-instagram" style="width: 65%;"></div>
                            </div>
                            <div style="font-size: 12px; color: var(--text-secondary); margin-top: 5px;">
                                65% of total engagement from video
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="data-table mt-40">
                    <div class="data-table-header">
                        <div>
                            <h3>Performance Summary</h3>
                            <p>Key metrics across all platforms</p>
                        </div>
                    </div>
                    <div class="data-table-content">
                        <table>
                            <thead>
                                <tr>
                                    <th>Platform</th>
                                    <th>Followers</th>
                                    <th>Engagement</th>
                                    <th>Reach</th>
                                    <th>Revenue</th>
                                    <th>Growth</th>
                                </tr>
                            </thead>
                            <tbody id="performanceSummary">
                                <!-- Performance data loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            // Load performance summary
            loadPerformanceSummary();
            
            // Initialize analytics charts
            setTimeout(() => {
                initializeAnalyticsCharts();
            }, 100);
        }

        // Load Revenue Page
        function loadRevenuePage(container) {
            document.getElementById('pageTitle').textContent = 'Revenue Dashboard';
            document.getElementById('pageSubtitle').textContent = 'Monetization analytics and revenue streams';
            
            container.innerHTML = `
                <div class="stats-grid mb-40">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: var(--success);">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <div class="stat-trend">
                                <i class="fas fa-arrow-up"></i> +24.7%
                            </div>
                        </div>
                        <div class="stat-content">
                            <h3>$24,850</h3>
                            <p>Monthly Social Revenue</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: var(--facebook);">
                                <i class="fab fa-facebook"></i>
                            </div>
                            <div class="stat-trend">
                                <i class="fas fa-arrow-up"></i> +18.2%
                            </div>
                        </div>
                        <div class="stat-content">
                            <h3>$8,950</h3>
                            <p>Facebook Ad Revenue</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: var(--instagram);">
                                <i class="fab fa-instagram"></i>
                            </div>
                            <div class="stat-trend">
                                <i class="fas fa-arrow-up"></i> +32.5%
                            </div>
                        </div>
                        <div class="stat-content">
                            <h3>$12,450</h3>
                            <p>Instagram Shopping</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: var(--twitter);">
                                <i class="fab fa-twitter"></i>
                            </div>
                            <div class="stat-trend">
                                <i class="fas fa-arrow-up"></i> +15.8%
                            </div>
                        </div>
                        <div class="stat-content">
                            <h3>$3,450</h3>
                            <p>Twitter Monetization</p>
                        </div>
                    </div>
                </div>
                
                <div class="charts-section">
                    <div class="charts-grid">
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <h3>Revenue Trends</h3>
                                    <p>Monthly revenue growth by platform</p>
                                </div>
                            </div>
                            <div class="chart-viz" id="chart-revenue-trends"></div>
                        </div>
                        
                        <div class="chart-container">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <h3>Revenue Sources</h3>
                                    <p>Breakdown of income streams</p>
                                </div>
                            </div>
                            <div class="chart-viz" id="chart-revenue-sources"></div>
                        </div>
                    </div>
                </div>
                
                <div class="data-table mt-40">
                    <div class="data-table-header">
                        <div>
                            <h3>Revenue Transactions</h3>
                            <p>Recent revenue-generating activities</p>
                        </div>
                        <button class="section-btn" onclick="exportRevenueData()">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                    <div class="data-table-content">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Platform</th>
                                    <th>Source</th>
                                    <th>Amount</th>
                                    <th>Campaign</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="revenueTransactions">
                                <!-- Transactions loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            // Load revenue transactions
            loadRevenueTransactions();
            
            // Initialize revenue charts
            setTimeout(() => {
                initializeRevenueCharts();
            }, 100);
        }

        // Load Reports Page
        function loadReportsPage(container) {
            document.getElementById('pageTitle').textContent = 'Reports & Insights';
            document.getElementById('pageSubtitle').textContent = 'Generated reports and detailed insights';
            
            container.innerHTML = `
                <div class="section-header mb-40">
                    <div>
                        <h2>Social Media Reports</h2>
                        <p>Generated reports and analytics exports</p>
                    </div>
                    <div class="section-actions">
                        <button class="section-btn" onclick="generateWeeklyReport()">
                            <i class="fas fa-plus"></i> New Report
                        </button>
                        <button class="section-btn primary" onclick="scheduleReports()">
                            <i class="fas fa-calendar-alt"></i> Schedule
                        </button>
                    </div>
                </div>
                
                <div class="stats-grid mb-40">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: var(--primary);">
                                <i class="fas fa-file-alt"></i>
                            </div>
                        </div>
                        <div class="stat-content">
                            <h3>24</h3>
                            <p>Generated Reports</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: var(--success);">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                        <div class="stat-content">
                            <h3>18</h3>
                            <p>Completed This Month</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: var(--warning);">
                                <i class="fas fa-clock"></i>
                            </div>
                        </div>
                        <div class="stat-content">
                            <h3>6</h3>
                            <p>Scheduled Reports</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: var(--info);">
                                <i class="fas fa-share-alt"></i>
                            </div>
                        </div>
                        <div class="stat-content">
                            <h3>89%</h3>
                            <p>Report Utilization</p>
                        </div>
                    </div>
                </div>
                
                <div class="data-table">
                    <div class="data-table-header">
                        <div>
                            <h3>Recent Reports</h3>
                            <p>Generated and scheduled reports</p>
                        </div>
                        <button class="section-btn" onclick="viewAllReports()">
                            <i class="fas fa-list"></i> View All
                        </button>
                    </div>
                    <div class="data-table-content">
                        <table>
                            <thead>
                                <tr>
                                    <th>Report</th>
                                    <th>Type</th>
                                    <th>Platform</th>
                                    <th>Period</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="reportsList">
                                <!-- Reports loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            // Load reports list
            loadReportsList();
        }

        // Load Comparison Page
        function loadComparisonPage(container) {
            document.getElementById('pageTitle').textContent = 'Platform Comparison';
            document.getElementById('pageSubtitle').textContent = 'Compare performance across social media platforms';
            
            container.innerHTML = `
                <div class="charts-section">
                    <div class="section-header">
                        <div>
                            <h2>Cross-Platform Comparison</h2>
                            <p>Side-by-side analysis of all connected platforms</p>
                        </div>
                        <div class="section-actions">
                            <button class="section-btn" onclick="exportComparison()">
                                <i class="fas fa-download"></i> Export
                            </button>
                            <button class="section-btn primary" onclick="refreshComparison()">
                                <i class="fas fa-sync"></i> Refresh
                            </button>
                        </div>
                    </div>
                    
                    <div class="chart-container mb-40">
                        <div class="chart-header">
                            <div class="chart-title">
                                <h3>Platform Performance Matrix</h3>
                                <p>Key metrics comparison across platforms</p>
                            </div>
                        </div>
                        <div class="chart-viz" id="chart-comparison-matrix"></div>
                    </div>
                </div>
                
                <div class="data-table">
                    <div class="data-table-header">
                        <div>
                            <h3>Detailed Comparison</h3>
                            <p>Metrics comparison table</p>
                        </div>
                    </div>
                    <div class="data-table-content">
                        <table>
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>Facebook</th>
                                    <th>Instagram</th>
                                    <th>Twitter</th>
                                    <th>Average</th>
                                    <th>Leader</th>
                                </tr>
                            </thead>
                            <tbody id="comparisonTable">
                                <!-- Comparison data loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            // Load comparison table
            loadComparisonTable();
            
            // Initialize comparison chart
            setTimeout(() => {
                initializeComparisonChart();
            }, 100);
        }

        // Load API Page
        function loadAPIPage(container) {
            document.getElementById('pageTitle').textContent = 'API Management';
            document.getElementById('pageSubtitle').textContent = 'Manage social media API connections';
            
            container.innerHTML = `
                <div class="section-header mb-40">
                    <div>
                        <h2>API Connections</h2>
                        <p>Manage your social media API integrations</p>
                    </div>
                    <div class="section-actions">
                        <button class="section-btn primary" onclick="testAllAPIs()">
                            <i class="fas fa-vial"></i> Test All APIs
                        </button>
                    </div>
                </div>
                
                <div class="stats-grid mb-40" id="apiCards"></div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <div class="chart-title">
                            <h3>API Usage & Limits</h3>
                            <p>API call usage and remaining quotas</p>
                        </div>
                    </div>
                    <div class="chart-viz" id="chart-api-usage"></div>
                </div>
                
                <div class="data-table mt-40">
                    <div class="data-table-header">
                        <div>
                            <h3>API Activity Log</h3>
                            <p>Recent API calls and responses</p>
                        </div>
                        <button class="section-btn" onclick="clearAPILogs()">
                            <i class="fas fa-trash"></i> Clear Logs
                        </button>
                    </div>
                    <div class="data-table-content">
                        <table>
                            <thead>
                                <tr>
                                    <th>Timestamp</th>
                                    <th>Platform</th>
                                    <th>Endpoint</th>
                                    <th>Status</th>
                                    <th>Response Time</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody id="apiLogs">
                                <!-- API logs loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            // Load API cards
            loadAPICards();
            
            // Load API logs
            loadAPILogs();
            
            // Initialize API usage chart
            setTimeout(() => {
                initializeAPIUsageChart();
            }, 100);
        }

        // Data Fetching Functions
        function fetchFacebookData() {
            fetchPlatformData('facebook');
        }

        function fetchInstagramData() {
            fetchPlatformData('instagram');
        }

        function fetchTwitterData() {
            fetchPlatformData('twitter');
        }

        function syncAllPlatforms() {
            showToast('Syncing all social media platforms...', 'info');
            
            const platforms = ['facebook', 'instagram', 'twitter'];
            let completed = 0;
            
            platforms.forEach(platform => {
                if (socialData[platform].api.connected) {
                    setTimeout(() => {
                        fetchPlatformData(platform);
                        completed++;
                        if (completed === platforms.filter(p => socialData[p].api.connected).length) {
                            showToast('All platforms synced successfully!', 'success');
                        }
                    }, completed * 1000);
                }
            });
        }

        function startAutoSync() {
            // Clear any existing interval
            if (autoSyncInterval) {
                clearInterval(autoSyncInterval);
            }
            
            // Auto-sync every 15 minutes
            autoSyncInterval = setInterval(() => {
                if (socialData.facebook.api.connected) fetchFacebookData();
                if (socialData.instagram.api.connected) fetchInstagramData();
                if (socialData.twitter.api.connected) fetchTwitterData();
                showToast('Auto-sync completed', 'info');
            }, 15 * 60 * 1000); // 15 minutes
        }

        // Platform Connection Functions
        function connectPlatform(platform) {
            // Use OAuth flow instead of simulation
            initiateOAuth(platform);
        }

        function connectAllPlatforms() {
            showToast('Connecting all platforms...', 'info');
            
            const platforms = ['facebook', 'instagram', 'twitter'];
            platforms.forEach((platform, index) => {
                setTimeout(() => {
                    connectPlatform(platform);
                }, index * 2000);
            });
        }

        function simulateSocialConnections() {
            // Simulate connecting all major platforms
            setTimeout(() => {
                socialData.facebook.api.connected = true;
                socialData.facebook.api.lastSync = new Date();
                socialData.facebook.stats = {
                    followers: 245000,
                    engagement: 4.7,
                    reach: 1250000,
                    revenue: 8950
                };
                
                socialData.instagram.api.connected = true;
                socialData.instagram.api.lastSync = new Date();
                socialData.instagram.stats = {
                    followers: 189000,
                    engagement: 6.2,
                    reach: 950000,
                    revenue: 12450
                };
                
                socialData.twitter.api.connected = true;
                socialData.twitter.api.lastSync = new Date();
                socialData.twitter.stats = {
                    followers: 89000,
                    engagement: 3.8,
                    reach: 420000,
                    revenue: 3450
                };
                
                // Update badges
                updatePlatformBadge('facebook');
                updatePlatformBadge('instagram');
                updatePlatformBadge('twitter');
                
                // Initialize API systems for demo connections
                initializeAPISystems();
            }, 1000);
        }

        // Update UI Functions
        function updatePlatformCards() {
            const container = document.getElementById('platformCards');
            if (!container) return;
            
            const platforms = ['facebook', 'instagram', 'twitter'];
            container.innerHTML = platforms.map(platform => {
                const data = socialData[platform];
                return `
                    <div class="platform-card ${platform}">
                        <div class="platform-header">
                            <div class="platform-icon ${platform}">
                                <i class="${data.icon}"></i>
                            </div>
                            <div class="platform-info">
                                <h4>${data.name}</h4>
                                <p>${data.api.connected ? 'Connected' : 'Not Connected'}</p>
                            </div>
                        </div>
                        
                        <div class="platform-stats">
                            <div class="platform-stat">
                                <h3>${formatNumber(data.stats.followers)}</h3>
                                <p>${platform === 'youtube' ? 'Subscribers' : 'Followers'}</p>
                            </div>
                            <div class="platform-stat">
                                <h3>${data.stats.engagement || '0'}%</h3>
                                <p>Engagement</p>
                            </div>
                            <div class="platform-stat">
                                <h3>$${formatNumber(data.stats.revenue)}</h3>
                                <p>Revenue</p>
                            </div>
                        </div>
                        
                        <div class="platform-actions">
                            <button class="platform-btn" onclick="fetchPlatformData('${platform}')">
                                <i class="fas fa-sync"></i> Sync
                            </button>
                            <button class="platform-btn" onclick="navigateToPage('${platform}')">
                                <i class="fas fa-chart-bar"></i> Analytics
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updatePlatformBadge(platform) {
            const badge = document.getElementById(`${platform}Badge`);
            if (badge) {
                badge.textContent = socialData[platform].api.connected ? 'Live' : 'Offline';
                badge.style.background = socialData[platform].api.connected ? 'var(--success)' : 'var(--danger)';
            }
        }

        function loadSocialActivities() {
            const container = document.getElementById('activityList');
            if (!container) return;
            
            const activities = [
                { platform: 'facebook', title: 'Facebook Ad Campaign Launched', description: 'New ad campaign started with $5,000 budget', time: '2 hours ago', icon: 'fa-ad', color: '#1877F2' },
                { platform: 'instagram', title: 'Instagram Reel Went Viral', description: 'Latest reel reached 1.2M views', time: '5 hours ago', icon: 'fa-video', color: '#E4405F' },
                { platform: 'twitter', title: 'Twitter Thread Trending', description: 'Product announcement thread got 5,200 retweets', time: '1 day ago', icon: 'fa-retweet', color: '#1DA1F2' },
                { platform: 'instagram', title: 'Instagram Shop Sale', description: 'Generated $2,450 in Instagram shopping revenue', time: '2 days ago', icon: 'fa-shopping-bag', color: '#E4405F' },
                { platform: 'facebook', title: 'Facebook Page Milestone', description: 'Reached 250,000 page likes', time: '3 days ago', icon: 'fa-trophy', color: '#1877F2' }
            ];
            
            container.innerHTML = activities.map(activity => `
                <li class="activity-item">
                    <div class="activity-icon" style="background: ${activity.color};">
                        <i class="fas ${activity.icon}"></i>
                    </div>
                    <div class="activity-details">
                        <h4>${activity.title}</h4>
                        <p>${activity.description}</p>
                    </div>
                    <div class="activity-time">${activity.time}</div>
                </li>
            `).join('');
        }

        // Utility Functions
        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            }
            if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num;
        }

        function formatTime(date) {
            if (!date) return 'Never';
            const now = new Date();
            const diff = now - new Date(date);
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);
            
            if (minutes < 1) return 'Just now';
            if (minutes < 60) return `${minutes}m ago`;
            if (hours < 24) return `${hours}h ago`;
            return `${days}d ago`;
        }

        // Initialize Social Charts
        function initializeSocialCharts() {
            // Audience Growth Chart
            if (document.getElementById('chart-audience')) {
                const audienceChart = new ApexCharts(document.getElementById('chart-audience'), {
                    series: [
                        { name: 'Facebook', data: [210, 215, 220, 225, 230, 235, 240, 245] },
                        { name: 'Instagram', data: [165, 170, 175, 178, 182, 185, 188, 189] },
                        { name: 'Twitter', data: [75, 78, 80, 82, 84, 86, 88, 89] }
                    ],
                    chart: { type: 'line', height: 300, toolbar: { show: false } },
                    colors: [SOCIAL_PLATFORMS.facebook.color, SOCIAL_PLATFORMS.instagram.color, SOCIAL_PLATFORMS.twitter.color],
                    stroke: { width: 3, curve: 'smooth' },
                    xaxis: { categories: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6', 'Week 7', 'Week 8'] },
                    legend: { position: 'top' }
                });
                chartInstances.audience = audienceChart;
                audienceChart.render();
            }
            
            // Revenue Chart
            if (document.getElementById('chart-revenue')) {
                const revenueChart = new ApexCharts(document.getElementById('chart-revenue'), {
                    series: [
                        { name: 'Facebook', data: [6500, 7200, 7800, 8200, 8600, 8800, 8950, 9100] },
                        { name: 'Instagram', data: [8500, 9200, 9800, 10500, 11200, 11800, 12450, 13000] },
                        { name: 'Twitter', data: [2800, 3000, 3200, 3300, 3400, 3450, 3500, 3550] }
                    ],
                    chart: { type: 'area', height: 300, toolbar: { show: false } },
                    colors: [SOCIAL_PLATFORMS.facebook.color, SOCIAL_PLATFORMS.instagram.color, SOCIAL_PLATFORMS.twitter.color],
                    stroke: { width: 2, curve: 'smooth' },
                    fill: { type: 'gradient', gradient: { shadeIntensity: 1, opacityFrom: 0.7, opacityTo: 0.1 } },
                    xaxis: { categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug'] }
                });
                chartInstances.revenue = revenueChart;
                revenueChart.render();
            }
        }

        // Initialize all API systems
        function initializeAPISystems() {
            // Load accounts
            ACCOUNT_MANAGER.loadAccounts();
            
            // Start connectivity monitoring for connected platforms
            Object.keys(socialData).forEach(platform => {
                if (socialData[platform].api.connected) {
                    CONNECTIVITY_MONITOR.monitorConnection(platform);
                }
            });
            
            // Setup webhooks for admin users
            if (currentUser && currentUser.role === 'admin') {
                WEBHOOK_MANAGER.setupWebhooks();
            }
            
            // Connect to real-time updates
            REALTIME_MANAGER.connectWebSocket();
            
            // Start security audit
            SECURITY_MANAGER.auditLog('system_init', {
                version: '1.0.0',
                user: currentUser?.email
            });
        }

        // Add OAuth callback handler (simulated for demo)
        function handleOAuthCallback(platform, code) {
            showToast(`Completing ${platform} connection...`, 'info');
            
            // Simulate token exchange
            setTimeout(() => {
                // Mock token response
                const mockTokens = {
                    access_token: `mock_${platform}_access_token_${Date.now()}`,
                    refresh_token: `mock_${platform}_refresh_token_${Date.now()}`,
                    expires_in: 3600,
                    token_type: 'bearer'
                };
                
                // Store tokens
                TOKEN_MANAGER.storeTokens(platform, mockTokens);
                
                // Add to account manager
                ACCOUNT_MANAGER.addAccount(platform, {
                    id: `acc_${Date.now()}`,
                    name: `${platform.charAt(0).toUpperCase() + platform.slice(1)} Account`,
                    type: 'business'
                });
                
                // Start monitoring
                CONNECTIVITY_MONITOR.monitorConnection(platform);
                
                showToast(`${platform.charAt(0).toUpperCase() + platform.slice(1)} connected successfully!`, 'success');
                
                // Refresh current view
                if (currentPage === 'platforms' || currentPage === 'overview' || currentPage === platform) {
                    navigateToPage(currentPage);
                }
            }, 2000);
        }

        // Update notification badge
        function updateNotificationBadge() {
            const notifications = JSON.parse(localStorage.getItem('mehan_notifications') || '[]');
            const unreadCount = notifications.filter(n => !n.read).length;
            
            const badge = document.querySelector('#notificationBtn .badge');
            if (badge) {
                badge.textContent = unreadCount > 0 ? unreadCount : '';
            }
        }

        // Simulate OAuth callback for demo purposes
        // In production, this would be handled by your backend
        window.addEventListener('load', function() {
            // Check for OAuth callback in URL (simulated)
            const urlParams = new URLSearchParams(window.location.search);
            const demoOAuth = urlParams.get('demo_oauth');
            
            if (demoOAuth) {
                const platform = demoOAuth.split('_')[0];
                const success = demoOAuth.split('_')[1] === 'success';
                
                if (success) {
                    handleOAuthCallback(platform, 'mock_auth_code');
                } else {
                    showToast(`${platform} connection cancelled`, 'warning');
                }
                
                // Clean URL
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        });

        // Update existing navigation to include API pages
        function loadAPIManagementCards() {
            const container = document.getElementById('apiCards');
            if (!container) return;
            
            const platforms = ['facebook', 'instagram', 'twitter'];
            
            container.innerHTML = platforms.map(platform => {
                const data = socialData[platform];
                const tokens = TOKEN_MANAGER.getTokens(platform);
                const rateLimit = RATE_LIMIT_MANAGER.getRateLimitStatus(platform);
                
                return `
                    <div class="platform-card ${platform}">
                        <div class="platform-header">
                            <div class="platform-icon ${platform}">
                                <i class="${data.icon}"></i>
                            </div>
                            <div class="platform-info">
                                <h4>${data.name} API</h4>
                                <p>Status: ${data.api.connected ? 'Connected' : 'Disconnected'}</p>
                                <div class="api-status ${data.api.connected ? 'connected' : 'disconnected'}">
                                    <i class="fas fa-circle"></i>
                                    ${data.api.connected ? 'API Active' : 'API Inactive'}
                                </div>
                            </div>
                        </div>
                        
                        <div class="platform-stats">
                            <div class="platform-stat">
                                <h3>${tokens ? '' : ''}</h3>
                                <p>Authenticated</p>
                            </div>
                            <div class="platform-stat">
                                <h3>${rateLimit ? rateLimit.remaining : '0'}</h3>
                                <p>API Calls Left</p>
                            </div>
                            <div class="platform-stat">
                                <h3>${data.api.lastSync ? formatTime(data.api.lastSync) : 'Never'}</h3>
                                <p>Last Sync</p>
                            </div>
                        </div>
                        
                        <div class="platform-actions">
                            <button class="platform-btn" onclick="fetchPlatformData('${platform}')" ${!data.api.connected ? 'disabled' : ''}>
                                <i class="fas fa-sync"></i> Test API
                            </button>
                            <button class="platform-btn" onclick="${data.api.connected ? `TOKEN_MANAGER.clearTokens('${platform}')` : `initiateOAuth('${platform}')`}">
                                <i class="fas fa-plug"></i> ${data.api.connected ? 'Disconnect' : 'Connect'}
                            </button>
                            <button class="platform-btn" onclick="showAPIDetails('${platform}')">
                                <i class="fas fa-info-circle"></i> Details
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function showAPIDetails(platform) {
            const tokens = TOKEN_MANAGER.getTokens(platform);
            const rateLimit = RATE_LIMIT_MANAGER.getRateLimitStatus(platform);
            const status = CONNECTIVITY_MONITOR.status[platform];
            
            const details = `
                <h3>${platform.charAt(0).toUpperCase() + platform.slice(1)} API Details</h3>
                <p><strong>Status:</strong> ${socialData[platform].api.connected ? 'Connected' : 'Disconnected'}</p>
                <p><strong>Last Sync:</strong> ${socialData[platform].api.lastSync ? new Date(socialData[platform].api.lastSync).toLocaleString() : 'Never'}</p>
                ${tokens ? `<p><strong>Token Expires:</strong> ${new Date(tokens.obtained_at + tokens.expires_in * 1000).toLocaleString()}</p>` : ''}
                ${rateLimit ? `
                    <p><strong>Rate Limit:</strong> ${rateLimit.used}/${rateLimit.limit}</p>
                    <p><strong>Resets In:</strong> ${Math.ceil(rateLimit.resetIn / 1000)} seconds</p>
                ` : ''}
                ${status ? `
                    <p><strong>Latency:</strong> ${status.latency}ms</p>
                    <p><strong>Uptime:</strong> ${status.uptime ? status.uptime.toFixed(1) + '%' : 'Unknown'}</p>
                ` : ''}
            `;
            
            // Create modal or show in toast
            showToast(details.replace(/<[^>]*>/g, ''), 'info'); // Strip HTML for toast
        }

        // Update existing functions
        function loadAPICards() {
            loadAPIManagementCards();
        }

        function loadAPILogs() {
            // Implement API logs loading
            const container = document.getElementById('apiLogs');
            if (!container) return;
            
            // Sample API logs for demo
            const logs = [
                { timestamp: new Date().toISOString(), platform: 'facebook', endpoint: '/me/accounts', status: '200 OK', responseTime: '245ms', details: 'Success' },
                { timestamp: new Date(Date.now() - 300000).toISOString(), platform: 'instagram', endpoint: '/me/media', status: '200 OK', responseTime: '189ms', details: 'Success' },
                { timestamp: new Date(Date.now() - 600000).toISOString(), platform: 'twitter', endpoint: '/2/users/me', status: '200 OK', responseTime: '312ms', details: 'Success' }
            ];
            
            container.innerHTML = logs.map(log => `
                <tr>
                    <td>${new Date(log.timestamp).toLocaleTimeString()}</td>
                    <td>${log.platform}</td>
                    <td>${log.endpoint}</td>
                    <td><span class="api-status connected">${log.status}</span></td>
                    <td>${log.responseTime}</td>
                    <td>${log.details}</td>
                </tr>
            `).join('');
        }

        function testAllAPIs() {
            showToast('Testing all API connections...', 'info');
            const platforms = ['facebook', 'instagram', 'twitter'];
            platforms.forEach(platform => {
                if (socialData[platform].api.connected) {
                    fetchPlatformData(platform);
                }
            });
        }

        function clearAPILogs() {
            showToast('API logs cleared', 'info');
            const container = document.getElementById('apiLogs');
            if (container) {
                container.innerHTML = '';
            }
        }

        // Existing utility functions (keep all your existing functions)
        function toggleTheme() {
            isDarkTheme = !isDarkTheme;
            document.body.classList.toggle('dark-theme', isDarkTheme);
            
            const themeIcon = document.querySelector('.theme-icon i');
            const themeText = document.querySelector('.theme-text');
            
            if (isDarkTheme) {
                themeIcon.className = 'fas fa-moon';
                themeText.textContent = 'Dark Mode';
                localStorage.setItem('mehan_theme', 'dark');
                showToast('Switched to Dark Mode', 'info');
            } else {
                themeIcon.className = 'fas fa-sun';
                themeText.textContent = 'Light Mode';
                localStorage.setItem('mehan_theme', 'light');
                showToast('Switched to Light Mode', 'info');
            }
        }

        function applyTheme() {
            const savedTheme = localStorage.getItem('mehan_theme') || 'light';
            isDarkTheme = savedTheme === 'dark';
            
            if (isDarkTheme) {
                document.body.classList.add('dark-theme');
                document.querySelector('.theme-icon i').className = 'fas fa-moon';
                document.querySelector('.theme-text').textContent = 'Dark Mode';
            }
        }

        function toggleMobileMenu() {
            document.getElementById('sidebar').classList.toggle('active');
        }

        function toggleNotifications() {
            const badge = document.querySelector('#notificationBtn .badge');
            if (badge.textContent === '3') {
                badge.textContent = '0';
                showToast('Notifications cleared', 'info');
            } else {
                badge.textContent = '3';
            }
        }

        function showHelp() {
            showToast('Opening help center...', 'info');
        }

        function handleLogout() {
            // Stop auto-sync
            if (autoSyncInterval) {
                clearInterval(autoSyncInterval);
            }
            
            // Stop monitoring
            CONNECTIVITY_MONITOR.stopAllMonitoring();
            
            // Disconnect WebSocket
            REALTIME_MANAGER.disconnect();
            
            localStorage.removeItem('mehan_user');
            currentUser = null;
            showLoginPage();
            showToast('Logged out successfully', 'info');
        }

        function handleSearch(e) {
            const query = e.target.value;
            if (query.length > 2) {
                showToast(`Searching social data for "${query}"...`, 'info');
            }
        }

        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <i class="fas fa-${getToastIcon(type)}"></i>
                <div>${message}</div>
            `;
            container.appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 10);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 5000);
        }

        function getToastIcon(type) {
            const icons = {
                success: 'check-circle',
                error: 'exclamation-circle',
                warning: 'exclamation-triangle',
                info: 'info-circle'
            };
            return icons[type] || 'info-circle';
        }

        // Additional social media functions
        function exportAllData() {
            showToast('Exporting all social media data...', 'success');
        }

        function viewAllActivity() {
            showToast('Opening activity log...', 'info');
        }

        function generateAnalyticsReport() {
            showToast('Generating analytics report...', 'info');
        }

        function refreshAnalytics() {
            showToast('Refreshing analytics data...', 'info');
        }

        function exportRevenueData() {
            showToast('Exporting revenue data...', 'success');
        }

        function generateWeeklyReport() {
            showToast('Generating weekly report...', 'info');
        }

        function scheduleReports() {
            showToast('Scheduling reports...', 'info');
        }

        function viewAllReports() {
            showToast('Opening reports dashboard...', 'info');
        }

        function exportComparison() {
            showToast('Exporting comparison data...', 'success');
        }

        function refreshComparison() {
            showToast('Refreshing comparison data...', 'info');
        }

        function showFacebookReports() {
            showToast('Opening Facebook reports...', 'info');
        }

        function showInstagramReports() {
            showToast('Opening Instagram reports...', 'info');
        }

        function showTwitterReports() {
            showToast('Opening Twitter reports...', 'info');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Add API management to platform connection buttons
            const socialButtons = document.querySelectorAll('.social-btn');
            socialButtons.forEach(button => {
                const originalOnClick = button.onclick;
                button.onclick = function() {
                    const platform = this.textContent.toLowerCase().trim();
                    initiateOAuth(platform);
                };
            });
        });

        console.log('%c Mehan.AI Social Media Analytics', 'color: #0066ff; font-size: 18px; font-weight: bold;');
        console.log('%cUnified social media analytics platform', 'color: #64748b;');
        console.log('%cFeatures:', 'color: #00ff9d; font-weight: bold;');
        console.log('%c Facebook, Instagram, Twitter analytics', 'color: #64748b;');
        console.log('%c Real-time data fetching', 'color: #64748b;');
        console.log('%c Revenue tracking and reporting', 'color: #64748b;');
        console.log('%c Cross-platform comparison', 'color: #64748b;');
        console.log('%c API Integration System Loaded', 'color: #00ff9d; font-size: 16px; font-weight: bold;');
        console.log('%c OAuth 2.0 Authentication', 'color: #64748b;');
        console.log('%c Token Management & Refresh', 'color: #64748b;');
        console.log('%c Real-time Webhook Support', 'color: #64748b;');
        console.log('%c Batch Processing & Caching', 'color: #64748b;');
        console.log('%c Advanced Security Features', 'color: #64748b;');
    </script>
</body>
</html>